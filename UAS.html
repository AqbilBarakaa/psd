
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PROYEK UAS: ANALISIS &amp; KLASIFIKASI KUALITAS STROBERI &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'UAS';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Menghitung jarak antara data lama (buka tutup) masing masing 100 data dengan data baru 1 data menggunakan Dynamic Time Warping (DTW)" href="jaraksuara.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.gif" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.gif" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to MyProfile
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="BusinessUnderstanding.html">Bussiness Understanding</a></li>
<li class="toctree-l1"><a class="reference internal" href="DataUnderstanding.html">Data Understanding dan Eksplorasi Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="DataPreprocessing.html">Data Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="PCAdanADASYN.html">Penerapan PCA dan ADASYN pada Dataset Ecoli</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modeling.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="PraUTS.html">PraUTS</a></li>
<li class="toctree-l1"><a class="reference internal" href="timeseries.html">Prediksi Nilai NO2 di Kota Depok, Jawa Barat dengan KNN Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="bukatutup.html">Identifikasi Audio “Buka Tutup”</a></li>
<li class="toctree-l1"><a class="reference internal" href="jaraksuara.html">Menghitung jarak antara data lama (buka tutup) masing masing 100 data dengan data baru 1 data menggunakan Dynamic Time Warping (DTW)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">PROYEK UAS: ANALISIS &amp; KLASIFIKASI KUALITAS STROBERI</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FUAS.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/UAS.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>PROYEK UAS: ANALISIS & KLASIFIKASI KUALITAS STROBERI</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#business-understanding">1. BUSINESS UNDERSTANDING</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#latar-belakang-masalah">1.1. Latar Belakang Masalah</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan-proyek">1.2. Tujuan Proyek</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manfaat-bisnis">1.3. Manfaat Bisnis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pertanyaan-analisis">1.4. Pertanyaan Analisis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodologi-crisp-dm">1.5. Metodologi: CRISP-DM</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">2. DATA UNDERSTANDING</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-library-dan-konfigurasi-tampilan">Import library dan konfigurasi tampilan.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-dataset-inspeksi-awal">Load Dataset &amp; Inspeksi Awal</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pengecekan-struktur-distribusi-kelas">Pengecekan Struktur &amp; Distribusi Kelas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#statistik-deskriptif">Statistik Deskriptif</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deteksi-outlier-berbasis-statistik-distance-to-centroid">Deteksi Outlier Berbasis Statistik (Distance to Centroid)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-data">3. PREPROCESSING DATA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eksperimen-seleksi-metode">Eksperimen Seleksi Metode</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eksekusi-final-visualisasi-before-vs-after">Eksekusi Final &amp; Visualisasi (Before vs After)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grafik-pipeline-tracking">Grafik Pipeline Tracking</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#komparasi-detail-per-kelas-sebelum-vs-sesudah">Komparasi Detail Per Kelas (Sebelum vs Sesudah)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling">4. MODELING</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling-data">Scaling Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#training-benchmarking-loop">Training &amp; Benchmarking Loop</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Training &amp; Benchmarking Loop</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confusion-matrix">Confusion Matrix</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluasi">5. EVALUASI</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-feature-importance">Analisis Feature Importance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-feature-importance">Visualisasi Feature Importance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kurva-roc-auc-seluruh-model">Kurva ROC-AUC Seluruh Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kurva-roc-auc-model-terbaik">Kurva ROC-AUC Model Terbaik</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#penyimpanan-model">PENYIMPANAN MODEL</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulasi-prediksi">Simulasi Prediksi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deployment">6. Deployment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-dan-simpan-model-pada-folder-deploy">Load dan simpan model pada folder deploy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#membuat-file-app-py-dengan-code">Membuat file <code class="docutils literal notranslate"><span class="pre">app.py</span></code> dengan code:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mempersiapkan-lingkungan-aplikasi">Mempersiapkan lingkungan aplikasi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menjalankan-aplikasi">Menjalankan Aplikasi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hasil-deploy">Hasil Deploy:</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="proyek-uas-analisis-klasifikasi-kualitas-stroberi">
<h1>PROYEK UAS: ANALISIS &amp; KLASIFIKASI KUALITAS STROBERI<a class="headerlink" href="#proyek-uas-analisis-klasifikasi-kualitas-stroberi" title="Link to this heading">#</a></h1>
<section id="business-understanding">
<h2>1. BUSINESS UNDERSTANDING<a class="headerlink" href="#business-understanding" title="Link to this heading">#</a></h2>
<p>Tahap ini bertujuan untuk memahami tujuan proyek dari perspektif bisnis dan menerjemahkannya ke dalam tugas teknis <em>data mining</em>.</p>
<section id="latar-belakang-masalah">
<h3>1.1. Latar Belakang Masalah<a class="headerlink" href="#latar-belakang-masalah" title="Link to this heading">#</a></h3>
<p>Industri pangan global menghadapi tantangan besar terkait pemalsuan makanan (<em>food fraud</em>). Produk olahan buah bernilai tinggi seperti <strong>stroberi</strong> sering menjadi sasaran pemalsuan, di mana buah asli dicampur dengan bahan lain yang lebih murah (apel, pewarna, gula berlebih) untuk menekan biaya produksi.</p>
<p>Metode pengujian konvensional seperti kromatografi atau uji DNA memiliki keterbatasan:</p>
<ul class="simple">
<li><p><strong>Biaya Tinggi:</strong> Memerlukan reagen kimia mahal dan peralatan laboratorium canggih.</p></li>
<li><p><strong>Waktu Lama:</strong> Proses preparasi dan analisis memakan waktu jam hingga hari, menghambat rantai pasok.</p></li>
<li><p><strong>Destruktif:</strong> Sampel yang diuji rusak dan tidak dapat dijual kembali.</p></li>
</ul>
</section>
<section id="tujuan-proyek">
<h3>1.2. Tujuan Proyek<a class="headerlink" href="#tujuan-proyek" title="Link to this heading">#</a></h3>
<p>Tujuan utama proyek ini adalah membangun sistem <strong>klasifikasi otomatis</strong> menggunakan <em>Machine Learning</em> yang dapat membedakan antara:</p>
<ol class="arabic simple">
<li><p><strong>Stroberi Murni (<em>Authentic</em>):</strong> Produk yang terbuat dari stroberi asli tanpa campuran.</p></li>
<li><p><strong>Stroberi Oplosan (<em>Adulterated</em>):</strong> Produk yang telah dicampur atau dipalsukan.</p></li>
</ol>
<p>Sistem ini akan menganalisis data <strong>Spektroskopi Inframerah (FTIR)</strong>, yang memungkinkan pengujian cepat, non-destruktif, dan akurat.</p>
</section>
<section id="manfaat-bisnis">
<h3>1.3. Manfaat Bisnis<a class="headerlink" href="#manfaat-bisnis" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Jaminan Kualitas (<em>Quality Assurance</em>):</strong> Memastikan produk yang sampai ke konsumen adalah asli.</p></li>
<li><p><strong>Efisiensi Operasional:</strong> Mempercepat proses pengecekan bahan baku di pabrik.</p></li>
<li><p><strong>Perlindungan Brand:</strong> Mencegah skandal pemalsuan yang dapat menghancurkan reputasi perusahaan.</p></li>
</ol>
</section>
<section id="pertanyaan-analisis">
<h3>1.4. Pertanyaan Analisis<a class="headerlink" href="#pertanyaan-analisis" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Apakah pola gelombang spektroskopi dapat membedakan stroberi asli dan palsu?</p></li>
<li><p>Bagian spektrum (panjang gelombang) mana yang menjadi penentu utama keaslian?</p></li>
<li><p>Seberapa akurat model dapat mendeteksi pemalsuan?</p></li>
</ul>
</section>
<section id="metodologi-crisp-dm">
<h3>1.5. Metodologi: CRISP-DM<a class="headerlink" href="#metodologi-crisp-dm" title="Link to this heading">#</a></h3>
<p>Analisis ini mengikuti standar <em>Cross-Industry Standard Process for Data Mining</em>:</p>
<ol class="arabic simple">
<li><p><strong>Business Understanding:</strong> Definisi masalah.</p></li>
<li><p><strong>Data Understanding:</strong> Eksplorasi pola spektral dan kualitas data.</p></li>
<li><p><strong>Data Preparation:</strong> Pembersihan dan transformasi data.</p></li>
<li><p><strong>Modeling:</strong> Pelatihan algoritma <em>Random Forest</em>.</p></li>
<li><p><strong>Evaluation:</strong> Validasi performa model dengan metrik komprehensif.</p></li>
<li><p><strong>Deployment:</strong> Implementasi model ke aplikasi web.</p></li>
</ol>
</section>
</section>
<section id="data-understanding">
<h2>2. DATA UNDERSTANDING<a class="headerlink" href="#data-understanding" title="Link to this heading">#</a></h2>
<p>Tahap ini berfokus pada pengumpulan dan eksplorasi data untuk memahami karakteristik sinyal spektroskopi.</p>
<p><strong>Deskripsi Dataset:</strong></p>
<ul class="simple">
<li><p><strong>Sumber:</strong> <em>UCR Time Series Classification Archive</em> (<a class="reference external" href="https://www.timeseriesclassification.com/description.php?Dataset=Strawberry">https://www.timeseriesclassification.com/description.php?Dataset=Strawberry</a>).</p></li>
<li><p><strong>Pengambilan:</strong>: Instrumen FTIR (Fourier Transform Infrared Spectroscopy).</p>
<ul>
<li><p>Alat ini menembakkan cahaya inframerah ke sampel stroberi.</p></li>
<li><p>Setiap molekul kimia (gula, air, serat stroberi) akan menyerap cahaya pada frekuensi yang berbeda.</p></li>
<li><p>Hasil serapan cahaya inilah yang menjadi angka-angka pada dataset (0.xxxx).</p></li>
</ul>
</li>
<li><p><strong>Jenis Data:</strong> Spektrograf (Intensitas cahaya pada berbagai panjang gelombang).</p></li>
<li><p><strong>Fitur:</strong> Setiap sampel terdiri dari <strong>235 titik data</strong> (panjang gelombang).</p></li>
<li><p><strong>Label Target:</strong></p>
<ul>
<li><p><strong>Kelas 1:</strong> Authentic (Stroberi Murni).</p></li>
<li><p><strong>Kelas 2:</strong> Adulterated (Stroberi Oplosan).</p></li>
</ul>
</li>
</ul>
<section id="import-library-dan-konfigurasi-tampilan">
<h3>Import library dan konfigurasi tampilan.<a class="headerlink" href="#import-library-dan-konfigurasi-tampilan" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import Library Utama</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>

<span class="c1"># Library Machine Learning &amp; Evaluasi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">StratifiedKFold</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.tree</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">imblearn.over_sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">SMOTE</span><span class="p">,</span> <span class="n">ADASYN</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.spatial.distance</span><span class="w"> </span><span class="kn">import</span> <span class="n">cdist</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyod.models.iforest</span><span class="w"> </span><span class="kn">import</span> <span class="n">IForest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyod.models.lof</span><span class="w"> </span><span class="kn">import</span> <span class="n">LOF</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyod.models.abod</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABOD</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.inspection</span><span class="w"> </span><span class="kn">import</span> <span class="n">permutation_importance</span>

<span class="c1"># Konfigurasi Tampilan Visualisasi</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titlesize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;lines.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Libraries berhasil diimpor.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Libraries berhasil diimpor.
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-dataset-inspeksi-awal">
<h3>Load Dataset &amp; Inspeksi Awal<a class="headerlink" href="#load-dataset-inspeksi-awal" title="Link to this heading">#</a></h3>
<p>Membaca file data mentah dan memeriksa dimensinya untuk memastikan tidak ada kesalahan pembacaan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fungsi Inspeksi Kualitas Data (Enhanced)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">inspect_data_quality</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;INSPEKSI DATASET: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Dimensi Data: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> Baris x </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> Kolom&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Tipe Data Dominan: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1"># Cek Missing Value</span>
    <span class="n">missing</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">status_missing</span> <span class="o">=</span> <span class="s2">&quot;Bersih (0)&quot;</span> <span class="k">if</span> <span class="n">missing</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;Ditemukan </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2"> Missing Values!&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Status Missing Value: </span><span class="si">{</span><span class="n">status_missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
    <span class="c1"># Cek Duplikasi Baris</span>
    <span class="n">duplicate</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">status_dup</span> <span class="o">=</span> <span class="s2">&quot;Tidak Ada (0)&quot;</span> <span class="k">if</span> <span class="n">duplicate</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;Ditemukan </span><span class="si">{</span><span class="n">duplicate</span><span class="si">}</span><span class="s2"> Data Duplikat!&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Status Duplikasi: </span><span class="si">{</span><span class="n">status_dup</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># EKSEKUSI</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Membaca file dengan separator spasi (format UCR)</span>
    <span class="n">df_train_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;Strawberry/Strawberry_TRAIN.txt&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">)</span>
    <span class="n">df_test_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;Strawberry/Strawberry_TEST.txt&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">)</span>
    
    <span class="c1"># Jalankan Inspeksi</span>
    <span class="n">inspect_data_quality</span><span class="p">(</span><span class="n">df_train_raw</span><span class="p">,</span> <span class="s2">&quot;TRAINING SET&quot;</span><span class="p">)</span>
    <span class="n">inspect_data_quality</span><span class="p">(</span><span class="n">df_test_raw</span><span class="p">,</span> <span class="s2">&quot;TESTING SET&quot;</span><span class="p">)</span>

    <span class="c1"># Pisahkan Label dan Fitur</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">df_train_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">X_train</span> <span class="o">=</span> <span class="n">df_train_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">y_test</span> <span class="o">=</span> <span class="n">df_test_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">df_test_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span>
    
    <span class="c1"># Mapping Kelas</span>
    <span class="n">class_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Authentic (Asli)&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Adulterated (Palsu)&#39;</span><span class="p">}</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Kelas Target: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">class_map</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: File dataset tidak ditemukan. Cek kembali path folder.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INSPEKSI DATASET: TRAINING SET
   - Dimensi Data: 613 Baris x 236 Kolom
   - Tipe Data Dominan: float64
   - Status Missing Value: Bersih (0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   - Status Duplikasi: Tidak Ada (0)
--------------------------------------------------
INSPEKSI DATASET: TESTING SET
   - Dimensi Data: 370 Baris x 236 Kolom
   - Tipe Data Dominan: float64
   - Status Missing Value: Bersih (0)
   - Status Duplikasi: Tidak Ada (0)
--------------------------------------------------
   Kelas Target: [1 2] {1: &#39;Authentic (Asli)&#39;, 2: &#39;Adulterated (Palsu)&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="pengecekan-struktur-distribusi-kelas">
<h3>Pengecekan Struktur &amp; Distribusi Kelas<a class="headerlink" href="#pengecekan-struktur-distribusi-kelas" title="Link to this heading">#</a></h3>
<p>Langkah ini memvalidasi proporsi data antar kelas. Ketidakseimbangan yang ekstrem (<em>Imbalanced Data</em>) dapat menyebabkan model bias, sehingga perlu dideteksi sejak dini. Selain itu, kita akan melihat statistik deskriptif dari intensitas sinyal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;df_train_raw&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ANALISIS STRUKTUR &amp; DISTRIBUSI&quot;</span><span class="p">)</span>
    
    <span class="c1"># Cek Label Unik &amp; Mapping</span>
    <span class="n">unique_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
    <span class="n">class_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Authentic (Murni)&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;Adulterated (Oplosan)&quot;</span><span class="p">}</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Label Kelas Ditemukan: </span><span class="si">{</span><span class="n">unique_labels</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">class_map</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1"># Hitung Distribusi Kelas</span>
    <span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">class_dist</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">class_map</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">unique</span><span class="p">],</span> <span class="n">counts</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Distribusi Sampel: </span><span class="si">{</span><span class="n">class_dist</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1"># Cek Rasio Imbalance</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Rasio Kelas Mayoritas vs Minoritas: </span><span class="si">{</span><span class="n">ratio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> : 1&quot;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">ratio</span> <span class="o">&gt;</span> <span class="mf">1.5</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   KESIMPULAN: Data Terindikasi TIDAK SEIMBANG. Perlu perhatian pada metrik evaluasi.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   KESIMPULAN: Data Cukup Seimbang (Balanced).&quot;</span><span class="p">)</span>
        
    <span class="c1"># Statistik Deskriptif Singkat (Fitur)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">STATISTIK INTENSITAS SPEKTRUM (Fitur):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Minimum Global : </span><span class="si">{</span><span class="n">X_train</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Maksimum Global: </span><span class="si">{</span><span class="n">X_train</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Rata-rata Global: </span><span class="si">{</span><span class="n">X_train</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Standar Deviasi : </span><span class="si">{</span><span class="n">X_train</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ANALISIS STRUKTUR &amp; DISTRIBUSI
   - Label Kelas Ditemukan: [1 2] -&gt; {1: &#39;Authentic (Murni)&#39;, 2: &#39;Adulterated (Oplosan)&#39;}
   - Distribusi Sampel: {&#39;Authentic (Murni)&#39;: 219, &#39;Adulterated (Oplosan)&#39;: 394}
   - Rasio Kelas Mayoritas vs Minoritas: 1.80 : 1
   KESIMPULAN: Data Terindikasi TIDAK SEIMBANG. Perlu perhatian pada metrik evaluasi.

STATISTIK INTENSITAS SPEKTRUM (Fitur):
   - Minimum Global : -2.3281
   - Maksimum Global: 3.6820
   - Rata-rata Global: 0.0000
   - Standar Deviasi : 0.9979
</pre></div>
</div>
</div>
</div>
</section>
<section id="statistik-deskriptif">
<h3>Statistik Deskriptif<a class="headerlink" href="#statistik-deskriptif" title="Link to this heading">#</a></h3>
<p>Tabel berikut menunjukkan ringkasan statistik (count, mean, std, min, max) untuk beberapa fitur (panjang gelombang) terpilih. Ini membantu kita melihat rentang nilai data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">STATISTIK DESKRIPTIF FITUR&quot;</span><span class="p">)</span>

<span class="c1"># Konversi ke DataFrame</span>
<span class="n">df_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">df_features</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Wave_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">df_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Tampilkan ringkasan statistik untuk 5 fitur pertama dan 5 fitur terakhir</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ringkasan Statistik (5 Fitur Awal &amp; Akhir):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_features</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="c1"># Analisis Variabilitas (Standar Deviasi Rata-rata)</span>
<span class="n">mean_std</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Rata-rata Standar Deviasi seluruh fitur: </span><span class="si">{</span><span class="n">mean_std</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">mean_std</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variasi data antar-sampel relatif rendah (data konsisten).&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variasi data cukup tinggi.&quot;</span><span class="p">)</span>

<span class="c1"># Cek Skewness (Kemencengan Distribusi)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Karakteristik Distribusi (Skewness):&quot;</span><span class="p">)</span>
<span class="n">skew_vals</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Fitur dengan Skewness Tertinggi: </span><span class="si">{</span><span class="n">skew_vals</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">skew_vals</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Fitur dengan Skewness Terendah : </span><span class="si">{</span><span class="n">skew_vals</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">skew_vals</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>STATISTIK DESKRIPTIF FITUR
Ringkasan Statistik (5 Fitur Awal &amp; Akhir):
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wave_0</th>
      <th>Wave_1</th>
      <th>Wave_2</th>
      <th>Wave_3</th>
      <th>Wave_4</th>
      <th>Wave_230</th>
      <th>Wave_231</th>
      <th>Wave_232</th>
      <th>Wave_233</th>
      <th>Wave_234</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>613.000000</td>
      <td>613.000000</td>
      <td>613.000000</td>
      <td>613.000000</td>
      <td>613.000000</td>
      <td>613.000000</td>
      <td>613.000000</td>
      <td>613.000000</td>
      <td>613.000000</td>
      <td>613.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-0.498551</td>
      <td>-0.495431</td>
      <td>-0.488475</td>
      <td>-0.461133</td>
      <td>-0.408259</td>
      <td>-1.127798</td>
      <td>-1.131651</td>
      <td>-1.135049</td>
      <td>-1.137789</td>
      <td>-1.137873</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.188252</td>
      <td>0.191853</td>
      <td>0.198986</td>
      <td>0.204857</td>
      <td>0.211983</td>
      <td>0.228709</td>
      <td>0.233164</td>
      <td>0.236439</td>
      <td>0.237282</td>
      <td>0.237259</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.412681</td>
      <td>-1.420112</td>
      <td>-1.429030</td>
      <td>-1.378990</td>
      <td>-1.323004</td>
      <td>-2.252661</td>
      <td>-2.295872</td>
      <td>-2.328144</td>
      <td>-2.323221</td>
      <td>-2.323221</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.566566</td>
      <td>-0.570064</td>
      <td>-0.564658</td>
      <td>-0.539658</td>
      <td>-0.494629</td>
      <td>-1.193747</td>
      <td>-1.196573</td>
      <td>-1.200201</td>
      <td>-1.201728</td>
      <td>-1.201728</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-0.458794</td>
      <td>-0.455784</td>
      <td>-0.449934</td>
      <td>-0.425987</td>
      <td>-0.379156</td>
      <td>-1.085191</td>
      <td>-1.089152</td>
      <td>-1.092728</td>
      <td>-1.094524</td>
      <td>-1.094524</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>-0.368683</td>
      <td>-0.362774</td>
      <td>-0.351894</td>
      <td>-0.321355</td>
      <td>-0.262244</td>
      <td>-0.995656</td>
      <td>-0.998685</td>
      <td>-1.004617</td>
      <td>-1.008367</td>
      <td>-1.008367</td>
    </tr>
    <tr>
      <th>max</th>
      <td>-0.218836</td>
      <td>-0.200100</td>
      <td>-0.142974</td>
      <td>-0.071614</td>
      <td>0.036565</td>
      <td>-0.754264</td>
      <td>-0.753381</td>
      <td>-0.751792</td>
      <td>-0.751262</td>
      <td>-0.751615</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rata-rata Standar Deviasi seluruh fitur: 0.1672
Variasi data antar-sampel relatif rendah (data konsisten).

Karakteristik Distribusi (Skewness):
- Fitur dengan Skewness Tertinggi: Wave_202 (2.23)
- Fitur dengan Skewness Terendah : Wave_38 (-2.27)
</pre></div>
</div>
</div>
</div>
</section>
<section id="exploratory-data-analysis-eda">
<h3>Exploratory Data Analysis (EDA)<a class="headerlink" href="#exploratory-data-analysis-eda" title="Link to this heading">#</a></h3>
<p>Visualisasi ini bertujuan untuk:</p>
<ol class="arabic simple">
<li><p><strong>Waveform Analysis:</strong> Membandingkan bentuk gelombang rata-rata antara kelas Asli dan Palsu, lengkap dengan area variabilitas (<em>standard deviation shading</em>) untuk melihat konsistensi data.</p></li>
<li><p><strong>PCA Projection:</strong> Memproyeksikan data berdimensi tinggi (235 fitur) ke dalam ruang 2D untuk melihat apakah kedua kelas dapat terpisah (<em>separable</em>) secara visual.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;df_train_raw&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">VISUALISASI EKSPLORATIF&quot;</span><span class="p">)</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    
    <span class="c1"># DISTRIBUSI KELAS (Pie Chart)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">class_map</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">unique</span><span class="p">],</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> 
                   <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#2ecc71&#39;</span><span class="p">,</span> <span class="s1">&#39;#e74c3c&#39;</span><span class="p">],</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">explode</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Proporsi Kelas Data Training&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="c1"># WAVEFORM ANALYSIS</span>
    <span class="n">X_auth</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="n">y_train</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">X_adul</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="n">y_train</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
    
    <span class="c1"># Hitung Statistik</span>
    <span class="n">mean_auth</span><span class="p">,</span> <span class="n">std_auth</span> <span class="o">=</span> <span class="n">X_auth</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">X_auth</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">mean_adul</span><span class="p">,</span> <span class="n">std_adul</span> <span class="o">=</span> <span class="n">X_adul</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">X_adul</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="c1"># Plotting</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">mean_auth</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rata-rata: Asli&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">mean_auth</span> <span class="o">-</span> <span class="n">std_auth</span><span class="p">,</span> <span class="n">mean_auth</span> <span class="o">+</span> <span class="n">std_auth</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
    
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">mean_adul</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rata-rata: Oplosan&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">mean_adul</span> <span class="o">-</span> <span class="n">std_adul</span><span class="p">,</span> <span class="n">mean_adul</span> <span class="o">+</span> <span class="n">std_adul</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
    
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Profil Spektroskopi (Mean ± Std Dev)&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Panjang Gelombang (Fitur)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Absorbansi&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># SEBARAN FITUR KUNCI (Boxplot)</span>
    <span class="n">plot_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">]:</span> 
        <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Nilai&#39;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="n">f</span><span class="p">],</span> <span class="s1">&#39;Kelas&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span> <span class="s1">&#39;Fitur&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Wave-</span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">})</span>
        <span class="n">plot_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
    <span class="n">df_box</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">plot_data</span><span class="p">)</span>
    
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Fitur&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Nilai&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Kelas&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_box</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#2ecc71&#39;</span><span class="p">,</span> <span class="s1">&#39;#e74c3c&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribusi Nilai pada Fitur Spesifik&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="c1"># PCA SEPARABILITY</span>
    <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">X_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    
    <span class="n">scatter</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_pca</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_pca</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlGn_r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Peta Persebaran Data (PCA 2D)&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PC1 (</span><span class="si">{</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> Var)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PC2 (</span><span class="si">{</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> Var)&quot;</span><span class="p">)</span>
    
    <span class="c1"># Legend Manual untuk PCA</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.lines</span><span class="w"> </span><span class="kn">import</span> <span class="n">Line2D</span>
    <span class="n">legend_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Asli&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
                       <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Palsu&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)]</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_elements</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ANALISIS VISUAL:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. [Waveform] Terlihat perbedaan pola yang jelas antara garis Hijau dan Merah, terutama pada indeks gelombang 0-100.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. [PCA] Titik data membentuk kelompok yang terpisah cukup baik, mengindikasikan bahwa model klasifikasi berpotensi memiliki akurasi tinggi.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. [Barchart] Terjadi ketidakseimbangan data antara Stoberi Murni dan Oplosan.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>VISUALISASI EKSPLORATIF
</pre></div>
</div>
<img alt="_images/4ff2ec5b6c5d331bd6346fe8dff529462ada7d87755e90105e86f9822b8a305c.png" src="_images/4ff2ec5b6c5d331bd6346fe8dff529462ada7d87755e90105e86f9822b8a305c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ANALISIS VISUAL:
1. [Waveform] Terlihat perbedaan pola yang jelas antara garis Hijau dan Merah, terutama pada indeks gelombang 0-100.
2. [PCA] Titik data membentuk kelompok yang terpisah cukup baik, mengindikasikan bahwa model klasifikasi berpotensi memiliki akurasi tinggi.
2. [Barchart] Terjadi ketidakseimbangan data antara Stoberi Murni dan Oplosan.
</pre></div>
</div>
</div>
</div>
</section>
<section id="deteksi-outlier-berbasis-statistik-distance-to-centroid">
<h3>Deteksi Outlier Berbasis Statistik (Distance to Centroid)<a class="headerlink" href="#deteksi-outlier-berbasis-statistik-distance-to-centroid" title="Link to this heading">#</a></h3>
<p>Untuk memastikan kualitas data, kita menggunakan pendekatan statistik dengan menghitung <strong>Jarak Euclidean</strong> setiap sampel stroberi asli (<em>Authentic</em>) terhadap “titik pusat” (<em>Centroid</em>) kelasnya.</p>
<ul class="simple">
<li><p><strong>Logika:</strong> Sampel stroberi asli yang berkualitas harus memiliki profil kimia yang mirip, sehingga jaraknya ke pusat rata-rata akan dekat (terkumpul di kiri grafik).</p></li>
<li><p><strong>Outlier:</strong> Jika ada sampel yang jaraknya sangat jauh dari pusat (berada di ekor kanan grafik), kemungkinan besar itu adalah sampel rusak, kesalahan sensor, atau data yang terkontaminasi <em>noise</em> parah.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ANALISIS DISTRIBUSI JARAK (DETEKSI OUTLIER)&quot;</span><span class="p">)</span>

<span class="c1"># Ambil Data Kelas Authentic (Asli)</span>
<span class="n">X_authentic</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="n">y_train</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Hitung Centroid (Titik Rata-rata Pusat)</span>
<span class="n">centroid_auth</span> <span class="o">=</span> <span class="n">X_authentic</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Hitung Jarak Setiap Sampel ke Centroid</span>
<span class="c1"># Menggunakan Jarak Euclidean</span>
<span class="n">distances</span> <span class="o">=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">X_authentic</span><span class="p">,</span> <span class="n">centroid_auth</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>

<span class="c1"># PLOT HISTOGRAM</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Histogram distribusi jarak</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># Tambahkan garis batas (Threshold) visual - misal di persentil 95 atau 99</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="mi">95</span><span class="p">)</span> <span class="c1"># Batas 95% data terdekat</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Threshold 95% (</span><span class="si">{</span><span class="n">threshold</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribusi Jarak Sampel &#39;Authentic&#39; ke Pusat Kelas&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Jarak Euclidean dari Centroid&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frekuensi (Jumlah Sampel)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Interpretasi Statistik</span>
<span class="n">max_dist</span> <span class="o">=</span> <span class="n">distances</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">min_dist</span> <span class="o">=</span> <span class="n">distances</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">mean_dist</span> <span class="o">=</span> <span class="n">distances</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;INTERPRETASI STATISTIK:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Rata-rata Jarak: </span><span class="si">{</span><span class="n">mean_dist</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Jarak Terjauh (Max): </span><span class="si">{</span><span class="n">max_dist</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   - ANALISIS: Sebagian besar data harus berkumpul di sebelah kiri (jarak pendek).&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;     Data yang berada di sebelah kanan garis merah (Threshold) adalah kandidat kuat OUTLIER&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;     yang memiliki karakteristik spektrum menyimpang dari standar stroberi asli.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ANALISIS DISTRIBUSI JARAK (DETEKSI OUTLIER)
</pre></div>
</div>
<img alt="_images/c15b2edd13579bf339bf164cf82490cd9f8a672c3435bf74399ee4375c94e188.png" src="_images/c15b2edd13579bf339bf164cf82490cd9f8a672c3435bf74399ee4375c94e188.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INTERPRETASI STATISTIK:
   - Rata-rata Jarak: 1.1658
   - Jarak Terjauh (Max): 4.8318
   - ANALISIS: Sebagian besar data harus berkumpul di sebelah kiri (jarak pendek).
     Data yang berada di sebelah kanan garis merah (Threshold) adalah kandidat kuat OUTLIER
     yang memiliki karakteristik spektrum menyimpang dari standar stroberi asli.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="preprocessing-data">
<h2>3. PREPROCESSING DATA<a class="headerlink" href="#preprocessing-data" title="Link to this heading">#</a></h2>
<p>Tahap ini bertujuan memperbaiki kualitas data latih (<em>Training Set</em>) agar model dapat belajar optimal. Berdasarkan temuan di Bab 2, kita menghadapi dua tantangan utama: potensi <em>outlier</em> dan ketidakseimbangan kelas.</p>
<p><strong>Strategi Preprocessing (Adaptive Pipeline):</strong></p>
<ol class="arabic simple">
<li><p><strong>Outlier Removal:</strong> Kita akan menguji tiga algoritma deteksi anomali:</p>
<ul class="simple">
<li><p><em>Isolation Forest (iForest):</em> Efektif untuk data dimensi tinggi.</p></li>
<li><p><em>Local Outlier Factor (LOF):</em> Mendeteksi anomali berdasarkan kerapatan lokal.</p></li>
<li><p><em>Angle-Based Outlier Detection (ABOD):</em> Menggunakan varians sudut (bagus untuk data spektrum).</p></li>
</ul>
</li>
<li><p><strong>Class Balancing:</strong> Kita akan menguji teknik <em>Oversampling</em>:</p>
<ul class="simple">
<li><p><em>SMOTE:</em> Membuat data sintetis di sepanjang garis hubung antar-sampel.</p></li>
<li><p><em>ADASYN:</em> Fokus membuat data sintetis di area yang sulit dipelajari (perbatasan kelas).</p></li>
</ul>
</li>
</ol>
<p>Pendekatan ini menggunakan <strong>Experimental Selection</strong>, di mana sistem akan otomatis memilih kombinasi metode terbaik berdasarkan validasi silang (Cross-Validation Score).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fungsi Evaluasi Kombinasi</span>
<span class="k">def</span><span class="w"> </span><span class="nf">evaluate_preprocessing</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">outlier_model</span><span class="p">,</span> <span class="n">resampler_model</span><span class="p">):</span>
    <span class="n">X_curr</span><span class="p">,</span> <span class="n">y_curr</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1"># Outlier Removal</span>
    <span class="k">if</span> <span class="n">outlier_model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">outlier_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_curr</span><span class="p">)</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">outlier_model</span><span class="o">.</span><span class="n">labels_</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> 
            <span class="n">X_curr</span> <span class="o">=</span> <span class="n">X_curr</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
            <span class="n">y_curr</span> <span class="o">=</span> <span class="n">y_curr</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

    <span class="c1"># Resampling </span>
    <span class="k">if</span> <span class="n">resampler_model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">X_curr</span><span class="p">,</span> <span class="n">y_curr</span> <span class="o">=</span> <span class="n">resampler_model</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_curr</span><span class="p">,</span> <span class="n">y_curr</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
            
    <span class="c1"># Validasi dengan Random Forest Sederhana</span>
    <span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="c1"># Gunakan F1-Macro agar adil untuk kedua kelas</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">X_curr</span><span class="p">,</span> <span class="n">y_curr</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;f1_macro&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_curr</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fungsi Evaluasi Siap Digunakan.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fungsi Evaluasi Siap Digunakan.
</pre></div>
</div>
</div>
</div>
<section id="eksperimen-seleksi-metode">
<h3>Eksperimen Seleksi Metode<a class="headerlink" href="#eksperimen-seleksi-metode" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EKSPERIMEN PEMILIHAN METODE&quot;</span><span class="p">)</span>

<span class="c1"># DEFINISI KANDIDAT METODE</span>
<span class="c1"># Outlier Detectors</span>
<span class="n">outlier_candidates</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Tanpa Outlier Removal&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;Isolation Forest&#39;</span><span class="p">:</span> <span class="n">IForest</span><span class="p">(</span><span class="n">contamination</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
    <span class="s1">&#39;LOF (Local Density)&#39;</span><span class="p">:</span> <span class="n">LOF</span><span class="p">(</span><span class="n">contamination</span><span class="o">=</span><span class="mf">0.05</span><span class="p">),</span>
    <span class="s1">&#39;ABOD (Angle-Based)&#39;</span><span class="p">:</span> <span class="n">ABOD</span><span class="p">(</span><span class="n">contamination</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Resamplers</span>
<span class="n">resampler_candidates</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Tanpa Resampling&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;SMOTE&#39;</span><span class="p">:</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
    <span class="s1">&#39;ADASYN&#39;</span><span class="p">:</span> <span class="n">ADASYN</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># JALANKAN LOOP PENGUJIAN</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">best_score</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">best_combo</span> <span class="o">=</span> <span class="p">{}</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;METODE OUTLIER&#39;</span><span class="si">:</span><span class="s2">&lt;25</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;METODE RESAMPLING&#39;</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;F1-SCORE&#39;</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;SAMPEL AKHIR&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>

<span class="k">for</span> <span class="n">out_name</span><span class="p">,</span> <span class="n">out_model</span> <span class="ow">in</span> <span class="n">outlier_candidates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">res_name</span><span class="p">,</span> <span class="n">res_model</span> <span class="ow">in</span> <span class="n">resampler_candidates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        
        <span class="c1"># Evaluasi</span>
        <span class="n">score</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">=</span> <span class="n">evaluate_preprocessing</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">out_model</span><span class="p">,</span> <span class="n">res_model</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">out_name</span><span class="si">:</span><span class="s2">&lt;25</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">res_name</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">     | </span><span class="si">{</span><span class="n">n_samples</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="c1"># Simpan Pemenang</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="n">best_score</span><span class="p">:</span>
            <span class="n">best_score</span> <span class="o">=</span> <span class="n">score</span>
            <span class="n">best_combo</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;out_name&#39;</span><span class="p">:</span> <span class="n">out_name</span><span class="p">,</span> <span class="s1">&#39;out_model&#39;</span><span class="p">:</span> <span class="n">out_model</span><span class="p">,</span>
                <span class="s1">&#39;res_name&#39;</span><span class="p">:</span> <span class="n">res_name</span><span class="p">,</span> <span class="s1">&#39;res_model&#39;</span><span class="p">:</span> <span class="n">res_model</span>
            <span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">JUARA KOMBINASI: </span><span class="si">{</span><span class="n">best_combo</span><span class="p">[</span><span class="s1">&#39;out_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">best_combo</span><span class="p">[</span><span class="s1">&#39;res_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   (Estimasi F1-Score: </span><span class="si">{</span><span class="n">best_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EKSPERIMEN PEMILIHAN METODE
METODE OUTLIER            | METODE RESAMPLING    | F1-SCORE   | SAMPEL AKHIR
--------------------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tanpa Outlier Removal     | Tanpa Resampling     | 0.9607     | 613
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tanpa Outlier Removal     | SMOTE                | 0.9708     | 788
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tanpa Outlier Removal     | ADASYN               | 0.9762     | 798
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Isolation Forest          | Tanpa Resampling     | 0.9506     | 582
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Isolation Forest          | SMOTE                | 0.9671     | 730
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Isolation Forest          | ADASYN               | 0.9720     | 751
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LOF (Local Density)       | Tanpa Resampling     | 0.9595     | 582
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LOF (Local Density)       | SMOTE                | 0.9661     | 738
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LOF (Local Density)       | ADASYN               | 0.9705     | 747
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ABOD (Angle-Based)        | Tanpa Resampling     | 0.9596     | 582
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ABOD (Angle-Based)        | SMOTE                | 0.9769     | 736
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ABOD (Angle-Based)        | ADASYN               | 0.9719     | 747
--------------------------------------------------------------------------------

JUARA KOMBINASI: ABOD (Angle-Based) + SMOTE
   (Estimasi F1-Score: 0.9769)
</pre></div>
</div>
</div>
</div>
</section>
<section id="eksekusi-final-visualisasi-before-vs-after">
<h3>Eksekusi Final &amp; Visualisasi (Before vs After)<a class="headerlink" href="#eksekusi-final-visualisasi-before-vs-after" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EKSEKUSI FINAL &amp; VISUALISASI PERUBAHAN&quot;</span><span class="p">)</span>

<span class="c1"># SIAPKAN DATA</span>
<span class="n">X_before</span><span class="p">,</span> <span class="n">y_before</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">y_train</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_cleaned</span><span class="p">,</span> <span class="n">y_cleaned</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">y_train</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_final</span><span class="p">,</span> <span class="n">y_final</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">y_train</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>     

<span class="c1"># EKSEKUSI OUTLIER REMOVAL (Tahap 1)</span>
<span class="k">if</span> <span class="n">best_combo</span><span class="p">[</span><span class="s1">&#39;out_model&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">model_out</span> <span class="o">=</span> <span class="n">best_combo</span><span class="p">[</span><span class="s1">&#39;out_model&#39;</span><span class="p">]</span>
    <span class="n">model_out</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_before</span><span class="p">)</span>
    <span class="n">mask_inlier</span> <span class="o">=</span> <span class="p">(</span><span class="n">model_out</span><span class="o">.</span><span class="n">labels_</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> 
    
    <span class="n">X_cleaned</span> <span class="o">=</span> <span class="n">X_before</span><span class="p">[</span><span class="n">mask_inlier</span><span class="p">]</span>
    <span class="n">y_cleaned</span> <span class="o">=</span> <span class="n">y_before</span><span class="p">[</span><span class="n">mask_inlier</span><span class="p">]</span>
    <span class="n">X_final</span><span class="p">,</span> <span class="n">y_final</span> <span class="o">=</span> <span class="n">X_cleaned</span><span class="p">,</span> <span class="n">y_cleaned</span> 
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tahap 1 (Cleaning) Selesai: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_before</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">X_cleaned</span><span class="p">)</span><span class="si">}</span><span class="s2"> outlier dibuang.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tahap 1 (Cleaning) Skipped (Sesuai hasil seleksi).&quot;</span><span class="p">)</span>

<span class="c1"># EKSEKUSI RESAMPLING (Tahap 2)</span>
<span class="k">if</span> <span class="n">best_combo</span><span class="p">[</span><span class="s1">&#39;res_model&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">model_res</span> <span class="o">=</span> <span class="n">best_combo</span><span class="p">[</span><span class="s1">&#39;res_model&#39;</span><span class="p">]</span>
    <span class="n">X_final</span><span class="p">,</span> <span class="n">y_final</span> <span class="o">=</span> <span class="n">model_res</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_final</span><span class="p">,</span> <span class="n">y_final</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tahap 2 (Balancing) Selesai: Total data menjadi </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_final</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tahap 2 (Balancing) Skipped (Sesuai hasil seleksi).&quot;</span><span class="p">)</span>

<span class="c1"># VISUALISASI BEFORE vs AFTER</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">my_palette</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Authentic (Murni)&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;Adulterated (Oplosan)&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}</span>

<span class="c1"># Pie Chart (Distribusi)</span>
<span class="c1"># Before</span>
<span class="n">u_bef</span><span class="p">,</span> <span class="n">c_bef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_before</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">c_bef</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">class_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u_bef</span><span class="p">],</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#2ecc71&#39;</span><span class="p">,</span> <span class="s1">&#39;#e74c3c&#39;</span><span class="p">],</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SEBELUM: Distribusi Kelas</span><span class="se">\n</span><span class="s2">(Total: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_before</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="c1"># After</span>
<span class="n">u_aft</span><span class="p">,</span> <span class="n">c_aft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_final</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">c_aft</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">class_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u_aft</span><span class="p">],</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#2ecc71&#39;</span><span class="p">,</span> <span class="s1">&#39;#e74c3c&#39;</span><span class="p">],</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SESUDAH: Distribusi Kelas</span><span class="se">\n</span><span class="s2">(Total: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_final</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># PCA Scatter (Struktur Data)</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Before</span>
<span class="n">X_pca_bef</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_before</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_pca_bef</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">X_pca_bef</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="p">[</span><span class="n">class_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">y_before</span><span class="p">],</span> <span class="n">palette</span><span class="o">=</span><span class="n">my_palette</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;SEBELUM: Peta Data (PCA)&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="c1"># After</span>
<span class="n">X_pca_aft</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_final</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_pca_aft</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">X_pca_aft</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="p">[</span><span class="n">class_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">y_final</span><span class="p">],</span> <span class="n">palette</span><span class="o">=</span><span class="n">my_palette</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;SESUDAH: Peta Data (PCA)&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># UPDATE VARIABEL GLOBAL UNTUK BAB SELANJUTNYA</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_final</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">y_final</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variabel X_train dan y_train telah diperbarui dengan data hasil preprocessing.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EKSEKUSI FINAL &amp; VISUALISASI PERUBAHAN
Tahap 1 (Cleaning) Selesai: 31 outlier dibuang.
Tahap 2 (Balancing) Selesai: Total data menjadi 736.
</pre></div>
</div>
<img alt="_images/e839393d085843dc4f3d9b9ebeb3668f52f7fb6983fedb02fb381828bb2245ec.png" src="_images/e839393d085843dc4f3d9b9ebeb3668f52f7fb6983fedb02fb381828bb2245ec.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variabel X_train dan y_train telah diperbarui dengan data hasil preprocessing.
</pre></div>
</div>
</div>
</div>
</section>
<section id="grafik-pipeline-tracking">
<h3>Grafik Pipeline Tracking<a class="headerlink" href="#grafik-pipeline-tracking" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ANALISIS PERUBAHAN JUMLAH DATA (Pipeline Tracking)&quot;</span><span class="p">)</span>

<span class="c1"># SIAPKAN DATA PLOTTING</span>
<span class="n">stages</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Data Awal</span><span class="se">\n</span><span class="s1">(Mentah)&#39;</span><span class="p">,</span> <span class="s1">&#39;Setelah Cleaning</span><span class="se">\n</span><span class="s1">(Outlier Dibuang)&#39;</span><span class="p">,</span> <span class="s1">&#39;Setelah Resampling</span><span class="se">\n</span><span class="s1">(Final)&#39;</span><span class="p">]</span>
<span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">X_before</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_cleaned</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_final</span><span class="p">)]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="s1">&#39;#e74c3c&#39;</span><span class="p">,</span> <span class="s1">&#39;#2ecc71&#39;</span><span class="p">]</span> <span class="c1"># Abu, Merah (Berkurang), Hijau (Bertambah)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">stages</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># TAMBAHKAN LABEL ANGKA DI ATAS BATANG</span>
<span class="k">for</span> <span class="n">bar</span> <span class="ow">in</span> <span class="n">bars</span><span class="p">:</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="o">*</span><span class="mf">0.02</span><span class="p">),</span>
             <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">height</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># TAMBAHKAN ANOTASI PERUBAHAN (PANAH &amp; TEXT)</span>
<span class="c1"># Info Pengurangan (Outlier Removal)</span>
<span class="n">diff_1</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">if</span> <span class="n">diff_1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="c1"># Posisi tengah antara batang 1 dan 2</span>
    <span class="n">mid_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">bars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bars</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_width</span><span class="p">())</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">mid_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dibuang: -</span><span class="si">{</span><span class="n">diff_1</span><span class="si">}</span><span class="se">\n</span><span class="s2">(Noise/Outlier)&quot;</span><span class="p">,</span> 
                 <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">mid_x</span><span class="p">,</span> <span class="n">mid_y</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">mid_x</span><span class="p">,</span> <span class="n">mid_y</span><span class="p">),</span>
                 <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                 <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.3&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">))</span>

<span class="c1"># Info Penambahan (Resampling)</span>
<span class="n">diff_2</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">if</span> <span class="n">diff_2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="c1"># Posisi tengah antara batang 2 dan 3</span>
    <span class="n">mid_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">bars</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bars</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bars</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_width</span><span class="p">())</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">mid_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">counts</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ditambah: +</span><span class="si">{</span><span class="n">diff_2</span><span class="si">}</span><span class="se">\n</span><span class="s2">(Sintetis)&quot;</span><span class="p">,</span> 
                 <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">mid_x</span><span class="p">,</span> <span class="n">mid_y</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">mid_x</span><span class="p">,</span> <span class="n">mid_y</span><span class="p">),</span>
                 <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                 <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.3&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">))</span>

<span class="c1"># Dekorasi Grafik</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pelacakan Perubahan Jumlah Sampel Data (Preprocessing)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Jumlah Sampel&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span> <span class="c1"># Memberi ruang kosong di atas untuk label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RINGKASAN AKHIR BAB 3:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;1. Data Awal            : </span><span class="si">{</span><span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> sampel.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2. Sampel Dibuang       : </span><span class="si">{</span><span class="n">diff_1</span><span class="si">}</span><span class="s2"> sampel (</span><span class="si">{</span><span class="p">(</span><span class="n">diff_1</span><span class="o">/</span><span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% dari data awal).&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;3. Sampel Ditambahkan   : </span><span class="si">{</span><span class="n">diff_2</span><span class="si">}</span><span class="s2"> sampel (Untuk menyeimbangkan kelas).&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;4. Total Data Siap Latih: </span><span class="si">{</span><span class="n">counts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2"> sampel.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ANALISIS PERUBAHAN JUMLAH DATA (Pipeline Tracking)
</pre></div>
</div>
<img alt="_images/84cf57adf2d7243ee1b91ef60e49b9fd7ab0e0bcb20f39409bab2a776379586d.png" src="_images/84cf57adf2d7243ee1b91ef60e49b9fd7ab0e0bcb20f39409bab2a776379586d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RINGKASAN AKHIR BAB 3:
1. Data Awal            : 613 sampel.
2. Sampel Dibuang       : 31 sampel (5.1% dari data awal).
3. Sampel Ditambahkan   : 154 sampel (Untuk menyeimbangkan kelas).
4. Total Data Siap Latih: 736 sampel.
</pre></div>
</div>
</div>
</div>
</section>
<section id="komparasi-detail-per-kelas-sebelum-vs-sesudah">
<h3>Komparasi Detail Per Kelas (Sebelum vs Sesudah)<a class="headerlink" href="#komparasi-detail-per-kelas-sebelum-vs-sesudah" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EVALUASI DETAIL PERUBAHAN DATA (PER KELAS)&quot;</span><span class="p">)</span>

<span class="c1"># MENYUSUN DATA UNTUK PLOTTING</span>
<span class="n">data_tracking</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Fungsi bantuan untuk menghitung per kelas</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_counts</span><span class="p">(</span><span class="n">y_data</span><span class="p">,</span> <span class="n">stage_name</span><span class="p">):</span>
    <span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_data</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span><span class="p">):</span>
        <span class="n">data_tracking</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;Tahapan&#39;</span><span class="p">:</span> <span class="n">stage_name</span><span class="p">,</span>
            <span class="s1">&#39;Kelas&#39;</span><span class="p">:</span> <span class="n">class_map</span><span class="p">[</span><span class="n">u</span><span class="p">],</span>
            <span class="s1">&#39;Jumlah&#39;</span><span class="p">:</span> <span class="n">c</span>
        <span class="p">})</span>

<span class="c1"># Ambil data</span>
<span class="k">if</span> <span class="s1">&#39;y_before&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;y_cleaned&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;y_final&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
    <span class="n">get_counts</span><span class="p">(</span><span class="n">y_before</span><span class="p">,</span> <span class="s1">&#39;1. Awal (Mentah)&#39;</span><span class="p">)</span>
    <span class="n">get_counts</span><span class="p">(</span><span class="n">y_cleaned</span><span class="p">,</span> <span class="s1">&#39;2. Setelah Cleaning</span><span class="se">\n</span><span class="s1">(Outlier Removal)&#39;</span><span class="p">)</span>
    <span class="n">get_counts</span><span class="p">(</span><span class="n">y_final</span><span class="p">,</span> <span class="s1">&#39;3. Setelah Resampling</span><span class="se">\n</span><span class="s1">(Final)&#39;</span><span class="p">)</span>

    <span class="n">df_track</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_tracking</span><span class="p">)</span>

    <span class="c1"># VISUALISASI GROUPED BAR CHART</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
    
    <span class="c1"># Gunakan palette warna konsisten</span>
    <span class="n">my_palette</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Authentic (Murni)&#39;</span><span class="p">:</span> <span class="s1">&#39;#2ecc71&#39;</span><span class="p">,</span> <span class="s1">&#39;Adulterated (Oplosan)&#39;</span><span class="p">:</span> <span class="s1">&#39;#e74c3c&#39;</span><span class="p">}</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_track</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Tahapan&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Jumlah&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Kelas&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">my_palette</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

    <span class="c1"># Dekorasi Grafik</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Perubahan Komposisi Kelas: Sebelum vs Sesudah Preprocessing&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Jumlah Sampel&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Kelas Stroberi&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

    <span class="c1"># Menambahkan Angka di Atas Batang</span>
    <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># OUTPUT TABEL RINGKASAN</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">TABEL RINCIAN PERUBAHAN:&quot;</span><span class="p">)</span>
    <span class="n">pivot_table</span> <span class="o">=</span> <span class="n">df_track</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;Kelas&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Tahapan&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Jumlah&#39;</span><span class="p">)</span>
    <span class="c1"># Mengurutkan kolom agar sesuai logika waktu</span>
    <span class="n">cols_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1. Awal (Mentah)&#39;</span><span class="p">,</span> <span class="s1">&#39;2. Setelah Cleaning</span><span class="se">\n</span><span class="s1">(Outlier Removal)&#39;</span><span class="p">,</span> <span class="s1">&#39;3. Setelah Resampling</span><span class="se">\n</span><span class="s1">(Final)&#39;</span><span class="p">]</span>
    <span class="n">display</span><span class="p">(</span><span class="n">pivot_table</span><span class="p">[</span><span class="n">cols_order</span><span class="p">])</span>
    
    <span class="c1"># Analisis Teks Otomatis</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">INTERPRETASI:&quot;</span><span class="p">)</span>
    <span class="n">diff_clean_auth</span> <span class="o">=</span> <span class="n">pivot_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Authentic (Murni)&#39;</span><span class="p">,</span> <span class="n">cols_order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">-</span> <span class="n">pivot_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Authentic (Murni)&#39;</span><span class="p">,</span> <span class="n">cols_order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">diff_clean_adul</span> <span class="o">=</span> <span class="n">pivot_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Adulterated (Oplosan)&#39;</span><span class="p">,</span> <span class="n">cols_order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">-</span> <span class="n">pivot_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Adulterated (Oplosan)&#39;</span><span class="p">,</span> <span class="n">cols_order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;1. Outlier Removal: Dibuang </span><span class="si">{</span><span class="n">diff_clean_auth</span><span class="si">}</span><span class="s2"> sampel Asli dan </span><span class="si">{</span><span class="n">diff_clean_adul</span><span class="si">}</span><span class="s2"> sampel Oplosan.&quot;</span><span class="p">)</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="n">final_auth</span> <span class="o">=</span> <span class="n">pivot_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Authentic (Murni)&#39;</span><span class="p">,</span> <span class="n">cols_order</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
        <span class="n">final_adul</span> <span class="o">=</span> <span class="n">pivot_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Adulterated (Oplosan)&#39;</span><span class="p">,</span> <span class="n">cols_order</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">final_auth</span> <span class="o">==</span> <span class="n">final_adul</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. Resampling: BERHASIL. Jumlah kedua kelas kini seimbang sempurna (50:50).&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2. Resampling: Jumlah data diperbaiki menjadi </span><span class="si">{</span><span class="n">final_auth</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">final_adul</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variabel data tidak ditemukan. Pastikan Cell 3.3 (Eksekusi Final) sudah dijalankan.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EVALUASI DETAIL PERUBAHAN DATA (PER KELAS)
</pre></div>
</div>
<img alt="_images/730f1d9925d2cc5751c0fc6ad09687c9aafd29fa2d07f8200acac5e1d43348f4.png" src="_images/730f1d9925d2cc5751c0fc6ad09687c9aafd29fa2d07f8200acac5e1d43348f4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TABEL RINCIAN PERUBAHAN:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Tahapan</th>
      <th>1. Awal (Mentah)</th>
      <th>2. Setelah Cleaning\n(Outlier Removal)</th>
      <th>3. Setelah Resampling\n(Final)</th>
    </tr>
    <tr>
      <th>Kelas</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Adulterated (Oplosan)</th>
      <td>394</td>
      <td>368</td>
      <td>368</td>
    </tr>
    <tr>
      <th>Authentic (Murni)</th>
      <td>219</td>
      <td>214</td>
      <td>368</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INTERPRETASI:
1. Outlier Removal: Dibuang 5 sampel Asli dan 26 sampel Oplosan.
2. Resampling: BERHASIL. Jumlah kedua kelas kini seimbang sempurna (50:50).
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="modeling">
<h2>4. MODELING<a class="headerlink" href="#modeling" title="Link to this heading">#</a></h2>
<p>Pada tahap ini, kita akan melatih berbagai algoritma Machine Learning untuk mempelajari pola dari data latih (<em>Training Set</em>) yang sudah dibersihkan.</p>
<p><strong>Strategi Modeling (Model Benchmarking):</strong>
Kita akan menguji 6 algoritma populer untuk melihat mana yang paling cocok dengan karakteristik data spektroskopi stroberi:</p>
<ol class="arabic simple">
<li><p><strong>Naive Bayes:</strong> Algoritma probabilistik sederhana (sebagai <em>baseline</em>).</p></li>
<li><p><strong>Logistic Regression:</strong> Model linear yang memisahkan kelas dengan garis lurus.</p></li>
<li><p><strong>Decision Tree:</strong> Model berbasis aturan (<em>rule-based</em>) pohon keputusan.</p></li>
<li><p><strong>Random Forest:</strong> Kumpulan banyak pohon keputusan (<em>ensemble</em>) untuk mengurangi overfitting.</p></li>
<li><p><strong>KNN (K-Nearest Neighbors):</strong> Klasifikasi berdasarkan kemiripan jarak dengan tetangga terdekat.</p></li>
<li><p><strong>SVM (Support Vector Machine):</strong> Mencari <em>hyperplane</em> terbaik untuk memisahkan kelas dalam ruang dimensi tinggi.</p></li>
</ol>
<p><strong>Metrik Evaluasi:</strong>
Model terbaik akan dipilih berdasarkan <strong>F1-Score (Macro Average)</strong> karena metrik ini paling adil dalam menilai performa rata-rata antar kelas.</p>
<section id="scaling-data">
<h3>Scaling Data<a class="headerlink" href="#scaling-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PERSIAPAN DATA MODELING&quot;</span><span class="p">)</span>

<span class="c1"># Pastikan Data Test Tersedia</span>
<span class="k">if</span> <span class="s1">&#39;X_test&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
    <span class="c1"># Load ulang test set jika perlu</span>
    <span class="n">df_test_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;Strawberry/Strawberry_TEST.txt&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">)</span>
    <span class="n">y_test</span> <span class="o">=</span> <span class="n">df_test_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">df_test_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Scaling Data (Standardization)</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="c1"># Fit pada Training data, transform ke Train dan Test</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data Scaling Selesai.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - X_train_scaled shape: </span><span class="si">{</span><span class="n">X_train_scaled</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - X_test_scaled shape : </span><span class="si">{</span><span class="n">X_test_scaled</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PERSIAPAN DATA MODELING
Data Scaling Selesai.
   - X_train_scaled shape: (736, 235)
   - X_test_scaled shape : (370, 235)
</pre></div>
</div>
</div>
</div>
</section>
<section id="training-benchmarking-loop">
<h3>Training &amp; Benchmarking Loop<a class="headerlink" href="#training-benchmarking-loop" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRAINING &amp; BENCHMARKING&quot;</span><span class="p">)</span>

<span class="c1"># Definisi Model</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Naive Bayes&quot;</span><span class="p">:</span> <span class="n">GaussianNB</span><span class="p">(),</span>
    <span class="s2">&quot;Logistic Regression&quot;</span><span class="p">:</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
    <span class="s2">&quot;Decision Tree&quot;</span><span class="p">:</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
    <span class="s2">&quot;Random Forest&quot;</span><span class="p">:</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
    <span class="s2">&quot;KNN (k=5)&quot;</span><span class="p">:</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
    <span class="s2">&quot;SVM (RBF Kernel)&quot;</span><span class="p">:</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Loop Training &amp; Evaluasi</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;MODEL&#39;</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;AKURASI&#39;</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;F1-SCORE&#39;</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;WAKTU (s)&#39;</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    
    <span class="c1"># Training</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Testing (Prediksi ke data test yang belum pernah dilihat)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
    
    <span class="c1"># Hitung Metrik</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span> <span class="c1"># Macro avg agar adil</span>
    
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
    
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Model&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="n">acc</span><span class="p">,</span>
        <span class="s1">&#39;F1_Score&#39;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
        <span class="s1">&#39;Time&#39;</span><span class="p">:</span> <span class="n">duration</span><span class="p">,</span>
        <span class="s1">&#39;Model_Obj&#39;</span><span class="p">:</span> <span class="n">model</span> <span class="c1"># Simpan objek model untuk nanti</span>
    <span class="p">})</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">acc</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">     | </span><span class="si">{</span><span class="n">f1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">     | </span><span class="si">{</span><span class="n">duration</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

<span class="c1"># Konversi ke DataFrame untuk Analisis</span>
<span class="n">df_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;F1_Score&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">best_model_name</span> <span class="o">=</span> <span class="n">df_results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Model&#39;</span><span class="p">]</span>
<span class="n">best_model_obj</span> <span class="o">=</span> <span class="n">df_results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Model_Obj&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">PEMENANG: </span><span class="si">{</span><span class="n">best_model_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   (F1-Score Tertinggi: </span><span class="si">{</span><span class="n">df_results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;F1_Score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TRAINING &amp; BENCHMARKING
MODEL                | AKURASI    | F1-SCORE   | WAKTU (s) 
------------------------------------------------------------
Naive Bayes          | 0.7892     | 0.7856     | 0.0044
Logistic Regression  | 0.9541     | 0.9508     | 0.0230
Decision Tree        | 0.9459     | 0.9409     | 0.1067
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random Forest        | 0.9595     | 0.9563     | 0.6937
KNN (k=5)            | 0.9351     | 0.9311     | 0.0285
SVM (RBF Kernel)     | 0.9324     | 0.9285     | 0.1127
------------------------------------------------------------

PEMENANG: Random Forest
   (F1-Score Tertinggi: 0.9563)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h3>Training &amp; Benchmarking Loop<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;VISUALISASI KOMPARASI MODEL (Accuracy vs F1-Score)&quot;</span><span class="p">)</span>

<span class="c1"># Menyiapkan Data untuk Plotting (Melting)</span>
<span class="n">df_plot</span> <span class="o">=</span> <span class="n">df_results</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;Model&#39;</span><span class="p">,</span> 
                          <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;F1_Score&#39;</span><span class="p">],</span> 
                          <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;Metrik&#39;</span><span class="p">,</span> 
                          <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Skor&#39;</span><span class="p">)</span>

<span class="c1"># Plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Skor&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Model&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Metrik&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_plot</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>

<span class="c1"># Dekorasi</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Perbandingan Performa 6 Algoritma Machine Learning&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Skor (0.0 - 1.0)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Algoritma&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">)</span> <span class="c1"># Beri ruang untuk label angka</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Metrik Evaluasi&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>

<span class="c1"># Tambahkan Label Angka di Ujung Batang</span>
<span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ANALISIS:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   - Grafik di atas membandingkan model berdasarkan dua metrik utama.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Pemenang (</span><span class="si">{</span><span class="n">best_model_name</span><span class="si">}</span><span class="s2">) memiliki batang paling panjang dan stabil di kedua metrik.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   - Jika selisih Akurasi dan F1-Score kecil, berarti model stabil menangani data imbalance.&quot;</span><span class="p">)</span>

<span class="c1"># Simpan model terbaik ke variabel global &#39;model_final&#39;</span>
<span class="n">model_final</span> <span class="o">=</span> <span class="n">best_model_obj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>VISUALISASI KOMPARASI MODEL (Accuracy vs F1-Score)
</pre></div>
</div>
<img alt="_images/061a6028f9ef6b8038fda3aba6fca2d9d3b5978f41c965ec1f855a0348850c93.png" src="_images/061a6028f9ef6b8038fda3aba6fca2d9d3b5978f41c965ec1f855a0348850c93.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ANALISIS:
   - Grafik di atas membandingkan model berdasarkan dua metrik utama.
   - Pemenang (Random Forest) memiliki batang paling panjang dan stabil di kedua metrik.
   - Jika selisih Akurasi dan F1-Score kecil, berarti model stabil menangani data imbalance.
</pre></div>
</div>
</div>
</div>
</section>
<section id="confusion-matrix">
<h3>Confusion Matrix<a class="headerlink" href="#confusion-matrix" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EVALUASI MENDALAM: </span><span class="si">{</span><span class="n">best_model_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Prediksi ulang menggunakan model terbaik</span>
<span class="n">y_pred_final</span> <span class="o">=</span> <span class="n">model_final</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>

<span class="c1"># Tampilkan Classification Report</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Laporan Klasifikasi Lengkap:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_final</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Authentic (Asli)&#39;</span><span class="p">,</span> <span class="s1">&#39;Adulterated (Palsu)&#39;</span><span class="p">]))</span>

<span class="c1"># Confusion Matrix</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_final</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Asli&#39;</span><span class="p">,</span> <span class="s1">&#39;Palsu&#39;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Asli&#39;</span><span class="p">,</span> <span class="s1">&#39;Palsu&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confusion Matrix - </span><span class="si">{</span><span class="n">best_model_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Label Sebenarnya (Ground Truth)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Label Prediksi Model&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CARA BACA CONFUSION MATRIX:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Benar Prediksi ASLI (True Pos): </span><span class="si">{</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> sampel.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Benar Prediksi PALSU (True Neg): </span><span class="si">{</span><span class="n">cm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> sampel.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Salah Prediksi (Asli dibilang Palsu): </span><span class="si">{</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> sampel -&gt; Bahaya! (Rejecting good product)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Salah Prediksi (Palsu dibilang Asli): </span><span class="si">{</span><span class="n">cm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> sampel -&gt; Bahaya! (Accepting fake product)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EVALUASI MENDALAM: RANDOM FOREST

Laporan Klasifikasi Lengkap:
                     precision    recall  f1-score   support

   Authentic (Asli)       0.92      0.97      0.94       132
Adulterated (Palsu)       0.98      0.95      0.97       238

           accuracy                           0.96       370
          macro avg       0.95      0.96      0.96       370
       weighted avg       0.96      0.96      0.96       370
</pre></div>
</div>
<img alt="_images/8af732a2e41f2d1d5e4361096b2c0b559d63a8dc46f2e0a60f560e655c884e3d.png" src="_images/8af732a2e41f2d1d5e4361096b2c0b559d63a8dc46f2e0a60f560e655c884e3d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CARA BACA CONFUSION MATRIX:
   - Benar Prediksi ASLI (True Pos): 128 sampel.
   - Benar Prediksi PALSU (True Neg): 227 sampel.
   - Salah Prediksi (Asli dibilang Palsu): 4 sampel -&gt; Bahaya! (Rejecting good product)
   - Salah Prediksi (Palsu dibilang Asli): 11 sampel -&gt; Bahaya! (Accepting fake product)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="evaluasi">
<h2>5. EVALUASI<a class="headerlink" href="#evaluasi" title="Link to this heading">#</a></h2>
<p>Setelah mendapatkan model terbaik, kita tidak cukup hanya melihat akurasi. Kita perlu menjawab pertanyaan: <strong>“Mengapa model memutuskan sebuah sampel itu Palsu?”</strong></p>
<p>Fokus evaluasi tahap ini:</p>
<ol class="arabic simple">
<li><p><strong>Feature Importance (Permutation Method):</strong> Mengidentifikasi titik panjang gelombang (<em>wavelength</em>) mana yang paling krusial dalam membedakan stroberi asli vs oplosan.</p></li>
<li><p><strong>ROC-AUC Curve:</strong> Mengukur seberapa mampu model memisahkan kedua kelas pada berbagai <em>threshold</em>.</p></li>
</ol>
<section id="analisis-feature-importance">
<h3>Analisis Feature Importance<a class="headerlink" href="#analisis-feature-importance" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ANALISIS FITUR PENTING (Permutation Importance)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sedang menghitung dampak setiap panjang gelombang terhadap model&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="s1">&#39;model_final&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
    <span class="c1"># Hitung Permutation Importance</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">permutation_importance</span><span class="p">(</span><span class="n">model_final</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;f1_macro&#39;</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    
    <span class="c1"># Ambil nilai rata-rata importance</span>
    <span class="n">importances</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">importances_mean</span>
    
    <span class="c1"># Urutkan dari yang paling penting</span>
    <span class="n">sorted_idx</span> <span class="o">=</span> <span class="n">importances</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Descending</span>
    
    <span class="c1"># Tampilkan Top 10 Fitur Paling Berpengaruh</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">TOP 10 PANJANG GELOMBANG PENENTU (Wavelength Indices):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;RANK&#39;</span><span class="si">:</span><span class="s2">&lt;5</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;INDEX FITUR&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;IMPORTANCE SCORE&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">sorted_idx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">importances</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">&lt;5</span><span class="si">}</span><span class="s2"> | Fitur_</span><span class="si">{</span><span class="n">idx</span><span class="si">:</span><span class="s2">&lt;9</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Variabel &#39;model_final&#39; tidak ditemukan. Pastikan Bab 4 sudah dijalankan.&quot;</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Perhitungan Selesai.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ANALISIS FITUR PENTING (Permutation Importance)
Sedang menghitung dampak setiap panjang gelombang terhadap model
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TOP 10 PANJANG GELOMBANG PENENTU (Wavelength Indices):
RANK  | INDEX FITUR     | IMPORTANCE SCORE
---------------------------------------------
1     | Fitur_65        | 0.004198
2     | Fitur_57        | 0.003074
3     | Fitur_1         | 0.002387
4     | Fitur_81        | 0.002103
5     | Fitur_19        | 0.002089
6     | Fitur_59        | 0.002089
7     | Fitur_74        | 0.002089
8     | Fitur_44        | 0.001987
9     | Fitur_56        | 0.001860
10    | Fitur_13        | 0.001790

Perhitungan Selesai.
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualisasi-feature-importance">
<h3>Visualisasi Feature Importance<a class="headerlink" href="#visualisasi-feature-importance" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;importances&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;VISUALISASI SPEKTRUM PENTING&quot;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    
    <span class="c1"># Plot semua fitur</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">importances</span><span class="p">)),</span> <span class="n">importances</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fitur Pendukung&#39;</span><span class="p">)</span>
    
    <span class="c1"># Highlight Top 10 Fitur dengan warna merah</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">sorted_idx</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">importances</span><span class="p">[</span><span class="n">sorted_idx</span><span class="p">[:</span><span class="mi">10</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Top 10 Fitur Kunci&#39;</span><span class="p">)</span>
    
    <span class="c1"># Dekorasi</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Feature Importance: Bagian Spektrum yang Membedakan Asli vs Palsu</span><span class="se">\n</span><span class="s2">(Model: </span><span class="si">{</span><span class="n">best_model_name</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Indeks Panjang Gelombang (0 - 234)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Tingkat Kepentingan (Drop in F1-Score)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    
    <span class="c1"># Tambahkan anotasi pada puncak tertinggi</span>
    <span class="n">top_feature</span> <span class="o">=</span> <span class="n">sorted_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pembeda Utama</span><span class="se">\n</span><span class="s1">(Idx: </span><span class="si">{</span><span class="n">top_feature</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> 
                 <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">top_feature</span><span class="p">,</span> <span class="n">importances</span><span class="p">[</span><span class="n">top_feature</span><span class="p">]),</span> 
                 <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">top_feature</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="n">importances</span><span class="p">[</span><span class="n">top_feature</span><span class="p">]</span><span class="o">+</span><span class="mf">0.02</span><span class="p">),</span>
                 <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;INTERPRETASI BISNIS &amp; KIMIA:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Grafik di atas bukan sekadar angka. Puncak-puncak merah adalah &#39;lokasi&#39; di mana pemalsuan terdeteksi.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2. Fitur ke-</span><span class="si">{</span><span class="n">top_feature</span><span class="si">}</span><span class="s2"> adalah indikator terkuat.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. Jika dikaitkan dengan ilmu pangan, panjang gelombang ini mungkin berkaitan dengan&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   gugus fungsi kimia tertentu (misal: ikatan O-H air atau C-H gula) yang kadarnya berbeda antara stroberi asli dan oplosan.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>VISUALISASI SPEKTRUM PENTING
</pre></div>
</div>
<img alt="_images/33fcdcc0720e9e6770ea84f9effcfe3758d26fd33b7adb805a43eddecc1e5c41.png" src="_images/33fcdcc0720e9e6770ea84f9effcfe3758d26fd33b7adb805a43eddecc1e5c41.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INTERPRETASI BISNIS &amp; KIMIA:
1. Grafik di atas bukan sekadar angka. Puncak-puncak merah adalah &#39;lokasi&#39; di mana pemalsuan terdeteksi.
2. Fitur ke-65 adalah indikator terkuat.
3. Jika dikaitkan dengan ilmu pangan, panjang gelombang ini mungkin berkaitan dengan
   gugus fungsi kimia tertentu (misal: ikatan O-H air atau C-H gula) yang kadarnya berbeda antara stroberi asli dan oplosan.
</pre></div>
</div>
</div>
</div>
</section>
<section id="kurva-roc-auc-seluruh-model">
<h3>Kurva ROC-AUC Seluruh Model<a class="headerlink" href="#kurva-roc-auc-seluruh-model" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;KURVA ROC Seluruh Model&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Cek apakah model mendukung probabilitas</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;predict_proba&quot;</span><span class="p">):</span>
            <span class="n">y_test_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_test</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            
            <span class="c1"># Prediksi Probabilitas </span>
            <span class="n">probs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
            
            <span class="c1"># Hitung FPR, TPR, AUC</span>
            <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test_bin</span><span class="p">,</span> <span class="n">probs</span><span class="p">)</span>
            <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>
            
            <span class="c1"># Plot Garis Model</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> (AUC = </span><span class="si">{</span><span class="n">roc_auc</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
            
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skip </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Plot Garis Tebakan Acak (Baseline)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Random Guess (0.500)&#39;</span><span class="p">)</span>

<span class="c1"># Dekorasi Grafik</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate (Salah Deteksi Barang Asli)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate (Sensitivitas Deteksi Barang Palsu)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Komparasi ROC Curve Seluruh Model&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;KETERANGAN:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. [Posisi Garis]: Semakin garis melengkung ke POJOK KIRI ATAS, semakin hebat modelnya.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. [Nilai AUC]: Lihat legenda. Nilai tertinggi (mendekati 1.000) adalah pemenangnya.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. [Stabilitas]: Jika ada model yang garisnya patah-patah atau di bawah garis putus-putus biru, berarti model itu buruk.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KURVA ROC Seluruh Model
</pre></div>
</div>
<img alt="_images/e91a5ac2fc3934a00679cb5980359a4316984641b41caa58dcb8b5de8e205c03.png" src="_images/e91a5ac2fc3934a00679cb5980359a4316984641b41caa58dcb8b5de8e205c03.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KETERANGAN:
1. [Posisi Garis]: Semakin garis melengkung ke POJOK KIRI ATAS, semakin hebat modelnya.
2. [Nilai AUC]: Lihat legenda. Nilai tertinggi (mendekati 1.000) adalah pemenangnya.
3. [Stabilitas]: Jika ada model yang garisnya patah-patah atau di bawah garis putus-putus biru, berarti model itu buruk.
</pre></div>
</div>
</div>
</div>
</section>
<section id="kurva-roc-auc-model-terbaik">
<h3>Kurva ROC-AUC Model Terbaik<a class="headerlink" href="#kurva-roc-auc-model-terbaik" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;KURVA ROC Model Terbaik&quot;</span><span class="p">)</span>

<span class="c1"># Cek predict_proba (Probabilitas)</span>
<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model_final</span><span class="p">,</span> <span class="s2">&quot;predict_proba&quot;</span><span class="p">):</span>
    <span class="c1"># Binarisasi Label sementara untuk keperluan plot ROC</span>
    <span class="n">y_test_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_test</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    
    <span class="c1"># Prediksi Probabilitas</span>
    <span class="n">y_prob</span> <span class="o">=</span> <span class="n">model_final</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># Ambil probabilitas kelas Palsu</span>
    
    <span class="c1"># Hitung FPR, TPR, Thresholds</span>
    <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test_bin</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">)</span>
    <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>
    
    <span class="c1"># Plotting</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC curve (AUC = </span><span class="si">{</span><span class="n">roc_auc</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Random Guess (0.50)&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate (Salah Deteksi Barang Asli)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate (Sensitivitas Deteksi Barang Palsu)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ROC Curve Model Terbaik - </span><span class="si">{</span><span class="n">best_model_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;KETERANGAN:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - Nilai AUC (Area Under Curve) adalah </span><span class="si">{</span><span class="n">roc_auc</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (Sempurna = 1.0).&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   - Semakin kurva mendekat ke pojok kiri atas, semakin hebat model memisahkan barang asli dan palsu&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;     tanpa banyak melakukan kesalahan (False Alarm).&quot;</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model </span><span class="si">{</span><span class="n">best_model_name</span><span class="si">}</span><span class="s2"> tidak mendukung probabilitas (predict_proba), visualisasi ROC dilewati.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KURVA ROC Model Terbaik
</pre></div>
</div>
<img alt="_images/4979b988603a39617d05bbbc82a0df8c56e24cbec6ce7086fbe1cde278a4c419.png" src="_images/4979b988603a39617d05bbbc82a0df8c56e24cbec6ce7086fbe1cde278a4c419.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KETERANGAN:
   - Nilai AUC (Area Under Curve) adalah 0.986 (Sempurna = 1.0).
   - Semakin kurva mendekat ke pojok kiri atas, semakin hebat model memisahkan barang asli dan palsu
     tanpa banyak melakukan kesalahan (False Alarm).
</pre></div>
</div>
</div>
</div>
</section>
<section id="penyimpanan-model">
<h3>PENYIMPANAN MODEL<a class="headerlink" href="#penyimpanan-model" title="Link to this heading">#</a></h3>
<p>Model terbaik yang telah dilatih dan dievaluasi kini siap untuk disimpan. Kita tidak hanya menyimpan model klasifikasi, tetapi juga objek <strong>Scaler</strong> (<em>StandardScaler</em>) yang digunakan untuk normalisasi data.</p>
<p><strong>Komponen yang Disimpan:</strong></p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">model_strawberry.pkl</span></code>: Otak pemrosesan (Algoritma Machine Learning terpilih).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scaler_strawberry.pkl</span></code>: Standarisasi data (Agar input dari aplikasi memiliki rentang nilai yang sama dengan data latih).</p></li>
</ol>
<p>Kedua file ini nantinya akan dipindahkan ke folder aplikasi <strong>Streamlit</strong> untuk proses deployment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MENYIMPAN MODEL &amp; SCALER&quot;</span><span class="p">)</span>

<span class="c1"># Pastikan variabel model dan scaler tersedia</span>
<span class="k">if</span> <span class="s1">&#39;model_final&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;scaler&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
    
    <span class="c1"># Tentukan Nama File</span>
    <span class="n">model_filename</span> <span class="o">=</span> <span class="s1">&#39;model_strawberry.pkl&#39;</span>
    <span class="n">scaler_filename</span> <span class="o">=</span> <span class="s1">&#39;scaler_strawberry.pkl&#39;</span>
    
    <span class="c1"># Proses Penyimpanan (Serialization)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model_final</span><span class="p">,</span> <span class="n">model_filename</span><span class="p">)</span>
        <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="n">scaler_filename</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Berhasil menyimpan Model  -&gt; </span><span class="si">{</span><span class="n">model_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Berhasil menyimpan Scaler -&gt; </span><span class="si">{</span><span class="n">scaler_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="c1"># Cek ukuran file</span>
        <span class="n">size_model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">model_filename</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1024</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ukuran Model: </span><span class="si">{</span><span class="n">size_model</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> KB&quot;</span><span class="p">)</span>
        
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gagal menyimpan: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Variabel &#39;model_final&#39; atau &#39;scaler&#39; tidak ditemukan.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MENYIMPAN MODEL &amp; SCALER
Berhasil menyimpan Model  -&gt; model_strawberry.pkl
Berhasil menyimpan Scaler -&gt; scaler_strawberry.pkl
Ukuran Model: 427.35 KB
</pre></div>
</div>
</div>
</div>
</section>
<section id="simulasi-prediksi">
<h3>Simulasi Prediksi<a class="headerlink" href="#simulasi-prediksi" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulasi Prediksi&quot;</span><span class="p">)</span>

<span class="c1"># LOAD MODEL &amp; SCALER (Pura-pura kita di aplikasi Streamlit)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">loaded_model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;model_strawberry.pkl&#39;</span><span class="p">)</span>
    <span class="n">loaded_scaler</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;scaler_strawberry.pkl&#39;</span><span class="p">)</span>
    
    <span class="c1"># PILIH 1 SAMPEL ACAK DARI DATA TEST</span>
    <span class="n">random_idx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="n">sample_raw</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[</span><span class="n">random_idx</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Bentuk harus 2D (1 baris, n kolom)</span>
    <span class="n">true_label_code</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">[</span><span class="n">random_idx</span><span class="p">]</span>
    <span class="n">true_label_text</span> <span class="o">=</span> <span class="n">class_map</span><span class="p">[</span><span class="n">true_label_code</span><span class="p">]</span>
    
    <span class="c1"># PREPROCESSING (Wajib Scale menggunakan Scaler yang dimuat)</span>
    <span class="n">sample_scaled</span> <span class="o">=</span> <span class="n">loaded_scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">sample_raw</span><span class="p">)</span>
    
    <span class="c1"># PREDIKSI</span>
    <span class="n">pred_code</span> <span class="o">=</span> <span class="n">loaded_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample_scaled</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">pred_text</span> <span class="o">=</span> <span class="n">class_map</span><span class="p">[</span><span class="n">pred_code</span><span class="p">]</span>
    
    <span class="c1"># Ambil probabilitas/confidence (jika model mendukung)</span>
    <span class="n">confidence</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">loaded_model</span><span class="p">,</span> <span class="s2">&quot;predict_proba&quot;</span><span class="p">):</span>
        <span class="n">probs</span> <span class="o">=</span> <span class="n">loaded_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">sample_scaled</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">confidence</span> <span class="o">=</span> <span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">pred_code</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">probs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Ambil probabilitas kelas terpilih</span>
    
    <span class="c1"># TAMPILKAN HASIL (Text &amp; Visual)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SAMPEL TEST INDEX: </span><span class="si">{</span><span class="n">random_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LABEL ASLI      : </span><span class="si">{</span><span class="n">true_label_text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PREDIKSI MODEL  : </span><span class="si">{</span><span class="n">pred_text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1"># Cek Kebenaran</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;✅ BENAR&quot;</span> <span class="k">if</span> <span class="n">pred_code</span> <span class="o">==</span> <span class="n">true_label_code</span> <span class="k">else</span> <span class="s2">&quot;❌ SALAH&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HASIL           : </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2"> (Confidence: </span><span class="si">{</span><span class="n">confidence</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    
    <span class="c1"># VISUALISASI SPEKTRUM</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    
    <span class="c1"># Plot Garis Spektrum Sampel Terpilih</span>
    <span class="n">color_line</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span> <span class="k">if</span> <span class="n">true_label_code</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;red&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sample_raw</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color_line</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Spektrum </span><span class="si">{</span><span class="n">true_label_text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Visualisasi Sinyal Sampel No. </span><span class="si">{</span><span class="n">random_idx</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">true_label_text</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Panjang Gelombang (Fitur)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Intensitas Absorbansi&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Terjadi kesalahan: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Simulasi Prediksi
============================================================
SAMPEL TEST INDEX: 140
LABEL ASLI      : Authentic (Murni)
PREDIKSI MODEL  : Authentic (Murni)
HASIL           : ✅ BENAR (Confidence: 100.00%)
============================================================
</pre></div>
</div>
<img alt="_images/1ff91c6566efdc18432b1177e969d4c11f67bc2649d714e87a846c8b40b5c169.png" src="_images/1ff91c6566efdc18432b1177e969d4c11f67bc2649d714e87a846c8b40b5c169.png" />
</div>
</div>
</section>
</section>
<section id="deployment">
<h2>6. Deployment<a class="headerlink" href="#deployment" title="Link to this heading">#</a></h2>
<section id="load-dan-simpan-model-pada-folder-deploy">
<h3>Load dan simpan model pada folder deploy<a class="headerlink" href="#load-dan-simpan-model-pada-folder-deploy" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Load &amp; Simpan model ke folder deploy&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Definisikan file aset dari pipeline kita</span>
<span class="n">MODEL_FILE</span> <span class="o">=</span> <span class="s2">&quot;model_strawberry.pkl&quot;</span>
<span class="n">SCALER_FILE</span> <span class="o">=</span> <span class="s2">&quot;scaler_strawberry.pkl&quot;</span>

<span class="c1"># Kumpulkan semua file dalam satu list</span>
<span class="n">FILE_LIST_TO_COPY</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">MODEL_FILE</span><span class="p">,</span>
    <span class="n">SCALER_FILE</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># folder tujuan</span>
<span class="n">SAVE_DIR</span> <span class="o">=</span> <span class="s2">&quot;../psd_deploy_uas&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">SAVE_DIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Folder tujuan disiapkan: </span><span class="si">{</span><span class="n">SAVE_DIR</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Buat fungsi copy yang efisien menggunakan shutil</span>
<span class="k">def</span><span class="w"> </span><span class="nf">copy_file_to_deploy</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">target_dir</span><span class="p">):</span>
    <span class="c1"># Periksa apakah file sumber ada</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">source_path</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File tidak ditemukan: </span><span class="si">{</span><span class="n">source_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Menyalin file secara langsung</span>
        <span class="n">target_path</span> <span class="o">=</span> <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">target_dir</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">source_path</span><span class="p">)</span><span class="si">}</span><span class="s2"> berhasil disalin ke: </span><span class="si">{</span><span class="n">target_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gagal menyalin </span><span class="si">{</span><span class="n">source_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Eksekusi untuk semua file</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mulai menyalin file aset ke folder deploy...&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">FILE_LIST_TO_COPY</span><span class="p">:</span>
    <span class="n">copy_file_to_deploy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">SAVE_DIR</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Semua file aset berhasil disalin ke folder deploy!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Load &amp; Simpan model ke folder deploy
==================================================
Folder tujuan disiapkan: ../psd_deploy_uas

Mulai menyalin file aset ke folder deploy...
model_strawberry.pkl berhasil disalin ke: ../psd_deploy_uas\model_strawberry.pkl
scaler_strawberry.pkl berhasil disalin ke: ../psd_deploy_uas\scaler_strawberry.pkl

Semua file aset berhasil disalin ke folder deploy!
</pre></div>
</div>
</div>
</div>
</section>
<section id="membuat-file-app-py-dengan-code">
<h3>Membuat file <code class="docutils literal notranslate"><span class="pre">app.py</span></code> dengan code:<a class="headerlink" href="#membuat-file-app-py-dengan-code" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">streamlit</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">st</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>

<span class="c1"># KONFIGURASI HALAMAN</span>
<span class="n">st</span><span class="o">.</span><span class="n">set_page_config</span><span class="p">(</span>
    <span class="n">page_title</span><span class="o">=</span><span class="s2">&quot;Strawberry Quality Check&quot;</span><span class="p">,</span>
    <span class="n">page_icon</span><span class="o">=</span><span class="s2">&quot;🍓&quot;</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;centered&quot;</span>
<span class="p">)</span>

<span class="c1"># CSS CUSTOMIZATION</span>
<span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;style&gt;</span>
<span class="s2">    /* Mengatur Font Global */</span>
<span class="s2">    html, body, [class*=&quot;css&quot;] {</span>
<span class="s2">        font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, sans-serif;</span>
<span class="s2">    }</span>
<span class="s2">    </span>
<span class="s2">    /* Header Utama */</span>
<span class="s2">    .main-header {</span>
<span class="s2">        background: linear-gradient(90deg, #C70039 0%, #900C3F 100%);</span>
<span class="s2">        padding: 20px;</span>
<span class="s2">        border-radius: 10px;</span>
<span class="s2">        color: white;</span>
<span class="s2">        text-align: center;</span>
<span class="s2">        margin-bottom: 30px;</span>
<span class="s2">        box-shadow: 0 4px 15px rgba(0,0,0,0.2);</span>
<span class="s2">    }</span>
<span class="s2">    .main-header h1 {</span>
<span class="s2">        font-size: 28px;</span>
<span class="s2">        font-weight: 700;</span>
<span class="s2">        margin: 0;</span>
<span class="s2">        color: white;</span>
<span class="s2">    }</span>
<span class="s2">    .main-header p {</span>
<span class="s2">        font-size: 14px;</span>
<span class="s2">        margin-top: 5px;</span>
<span class="s2">        opacity: 0.9;</span>
<span class="s2">    }</span>

<span class="s2">    /* Styling Tombol */</span>
<span class="s2">    .stButton&gt;button {</span>
<span class="s2">        width: 100%;</span>
<span class="s2">        background-color: #C70039;</span>
<span class="s2">        color: white;</span>
<span class="s2">        font-weight: 600;</span>
<span class="s2">        border-radius: 8px;</span>
<span class="s2">        height: 50px;</span>
<span class="s2">        border: none;</span>
<span class="s2">        transition: all 0.3s ease;</span>
<span class="s2">    }</span>
<span class="s2">    .stButton&gt;button:hover {</span>
<span class="s2">        background-color: #900C3F;</span>
<span class="s2">        box-shadow: 0 5px 15px rgba(199, 0, 57, 0.4);</span>
<span class="s2">        transform: translateY(-2px);</span>
<span class="s2">    }</span>

<span class="s2">    /* Result Card Styling */</span>
<span class="s2">    .result-card {</span>
<span class="s2">        background-color: white;</span>
<span class="s2">        padding: 25px;</span>
<span class="s2">        border-radius: 15px;</span>
<span class="s2">        text-align: center;</span>
<span class="s2">        box-shadow: 0 10px 25px rgba(0,0,0,0.08);</span>
<span class="s2">        border-top: 5px solid #ccc;</span>
<span class="s2">        color: #333;</span>
<span class="s2">    }</span>
<span class="s2">    </span>
<span class="s2">    /* Status Colors */</span>
<span class="s2">    .status-authentic {</span>
<span class="s2">        border-top-color: #28a745 !important;</span>
<span class="s2">    }</span>
<span class="s2">    .status-adulterated {</span>
<span class="s2">        border-top-color: #dc3545 !important;</span>
<span class="s2">    }</span>
<span class="s2">    </span>
<span class="s2">    .result-title {</span>
<span class="s2">        font-size: 24px;</span>
<span class="s2">        font-weight: 800;</span>
<span class="s2">        margin-bottom: 10px;</span>
<span class="s2">        text-transform: uppercase;</span>
<span class="s2">        letter-spacing: 1px;</span>
<span class="s2">    }</span>
<span class="s2">    .result-desc {</span>
<span class="s2">        font-size: 16px;</span>
<span class="s2">        color: #666;</span>
<span class="s2">        line-height: 1.5;</span>
<span class="s2">    }</span>
<span class="s2">&lt;/style&gt;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># LOAD MODEL &amp; SCALER</span>
<span class="nd">@st</span><span class="o">.</span><span class="n">cache_resource</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_resources</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Load Model dan Scaler</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;model_strawberry.pkl&#39;</span><span class="p">)</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;scaler_strawberry.pkl&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">scaler</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

<span class="c1"># HEADER INTERFACE</span>
<span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;div class=&#39;main-header&#39;&gt;</span>
<span class="s2">    &lt;h1&gt;SISTEM DETEKSI KEASLIAN STROBERI&lt;/h1&gt;</span>
<span class="s2">    &lt;p&gt;Analisis Spektroskopi Berbasis Machine Learning&lt;/p&gt;</span>
<span class="s2">&lt;/div&gt;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Load resources</span>
<span class="n">model</span><span class="p">,</span> <span class="n">scaler</span> <span class="o">=</span> <span class="n">load_resources</span><span class="p">()</span>

<span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">scaler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;SYSTEM ERROR: File model atau scaler tidak ditemukan. Harap unggah file .pkl.&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

<span class="c1"># SIDEBAR </span>
<span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="p">:</span>
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;### SUMBER DATASET&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">caption</span><span class="p">(</span><span class="s2">&quot;Model ini dilatih menggunakan dataset publik:&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span>
        <span class="s2">&quot;[UCR Strawberry Dataset](https://www.timeseriesclassification.com/description.php?Dataset=Strawberry)&quot;</span><span class="p">,</span>
        <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;### INFORMASI&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    - **Metode:** Random Forest Classifier</span>
<span class="s2">    - *Input:** 235 Titik Gelombang Spektrum</span>
<span class="s2">    - **Output:** Binary Classification</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
    
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;**Panduan:**&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;1. Siapkan file .txt/.csv hasil Scan Spektroskopi.&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;2. Pastikan format data numerik.&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;3. Klik tombol analisis.&quot;</span><span class="p">)</span>

<span class="c1"># UPLOAD DATA</span>
<span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;### 1. Upload Data Sampel&quot;</span><span class="p">)</span>
<span class="n">uploaded_file</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">file_uploader</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;txt&#39;</span><span class="p">,</span> <span class="s1">&#39;csv&#39;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Unggah file spektroskopi mentah di sini&quot;</span><span class="p">)</span>

<span class="n">input_data</span> <span class="o">=</span> <span class="kc">None</span> 

<span class="k">if</span> <span class="n">uploaded_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">uploaded_file</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        
        <span class="c1"># Deteksi pemisah</span>
        <span class="k">if</span> <span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\s+&quot;</span>
            
        <span class="n">uploaded_file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uploaded_file</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">)</span>
        <span class="n">data_values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span>
        
        <span class="c1"># Handling Kolom</span>
        <span class="k">if</span> <span class="n">data_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">235</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">toast</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Info: Memotong kolom label. Menggunakan 235 fitur terakhir.&quot;</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">input_data</span> <span class="o">=</span> <span class="n">data_values</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span> 
        <span class="k">elif</span> <span class="n">data_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">235</span><span class="p">:</span>
            <span class="n">input_data</span> <span class="o">=</span> <span class="n">data_values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FORMAT ERROR: Data memiliki </span><span class="si">{</span><span class="n">data_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> kolom. Dibutuhkan 235 kolom.&quot;</span><span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

        <span class="c1"># Ambil sampel pertama</span>
        <span class="n">input_data</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">input_data</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># Tampilkan preview data mini dalam expander</span>
        <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="s2">&quot;Lihat Data Mentah&quot;</span><span class="p">):</span>
            <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">input_data</span><span class="p">),</span> <span class="n">hide_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gagal membaca file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

<span class="c1"># VISUALISASI &amp; PREDIKSI</span>
<span class="k">if</span> <span class="n">input_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    
    <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;### 2. Analisis Spektrum&quot;</span><span class="p">)</span>
    
    <span class="c1"># CHART</span>
    <span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">235</span><span class="p">)</span>
    <span class="n">y_axis</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x_axis</span><span class="p">,</span> 
        <span class="n">y</span><span class="o">=</span><span class="n">y_axis</span><span class="p">,</span> 
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> 
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Sampel&#39;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#C70039&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
        <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;tozeroy&#39;</span><span class="p">,</span> 
        <span class="n">fillcolor</span><span class="o">=</span><span class="s1">&#39;rgba(199, 0, 57, 0.1)&#39;</span>
    <span class="p">))</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Visualisasi Gelombang Spektroskopi&quot;</span><span class="p">,</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;Titik Panjang Gelombang&quot;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Intensitas Absorbansi&quot;</span><span class="p">,</span>
        <span class="n">template</span><span class="o">=</span><span class="s2">&quot;plotly_white&quot;</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span>
        <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
        <span class="n">hovermode</span><span class="o">=</span><span class="s2">&quot;x&quot;</span>
    <span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># TOMBOL PREDIKSI</span>
    <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;### 3. Hasil Diagnosa&quot;</span><span class="p">)</span>
    
    <span class="n">col_btn_1</span><span class="p">,</span> <span class="n">col_btn_2</span><span class="p">,</span> <span class="n">col_btn_3</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">with</span> <span class="n">col_btn_2</span><span class="p">:</span>
        <span class="n">predict_btn</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;JALANKAN ANALISIS&quot;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">predict_btn</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&quot;Sedang memproses algoritma...&quot;</span><span class="p">):</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
            
            <span class="c1"># PREDIKSI</span>
            <span class="n">input_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>
            <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_scaled</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="c1"># Hitung Probabilitas</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;predict_proba&quot;</span><span class="p">):</span>
                <span class="n">probs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">input_scaled</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">confidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">confidence</span> <span class="o">=</span> <span class="mf">100.0</span>
            
            <span class="c1"># LOGIKA HASIL</span>
            <span class="k">if</span> <span class="n">prediction</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">label_text</span> <span class="o">=</span> <span class="s2">&quot;AUTHENTIC (ASLI)&quot;</span>
                <span class="n">desc_text</span> <span class="o">=</span> <span class="s2">&quot;Sampel terverifikasi memiliki profil kimia stroberi murni.&quot;</span>
                <span class="n">status_class</span> <span class="o">=</span> <span class="s2">&quot;status-authentic&quot;</span>
                <span class="n">text_color</span> <span class="o">=</span> <span class="s2">&quot;#28a745&quot;</span>
                <span class="n">gauge_color</span> <span class="o">=</span> <span class="s2">&quot;#28a745&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label_text</span> <span class="o">=</span> <span class="s2">&quot;ADULTERATED (OPLOSAN)&quot;</span>
                <span class="n">desc_text</span> <span class="o">=</span> <span class="s2">&quot;Terdeteksi anomali komposisi kimia pada sampel.&quot;</span>
                <span class="n">status_class</span> <span class="o">=</span> <span class="s2">&quot;status-adulterated&quot;</span>
                <span class="n">text_color</span> <span class="o">=</span> <span class="s2">&quot;#dc3545&quot;</span>
                <span class="n">gauge_color</span> <span class="o">=</span> <span class="s2">&quot;#dc3545&quot;</span>

            <span class="c1"># TAMPILAN HASIL DASHBOARD</span>
            <span class="n">col_res1</span><span class="p">,</span> <span class="n">col_res2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
            
            <span class="c1"># Kolom Kiri: Teks Penjelasan</span>
            <span class="k">with</span> <span class="n">col_res1</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                &lt;div class=&#39;result-card </span><span class="si">{</span><span class="n">status_class</span><span class="si">}</span><span class="s2">&#39;&gt;</span>
<span class="s2">                    &lt;div style=&#39;color: #888; font-size: 12px; margin-bottom: 5px;&#39;&gt;HASIL PREDIKSI&lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&#39;result-title&#39; style=&#39;color: </span><span class="si">{</span><span class="n">text_color</span><span class="si">}</span><span class="s2">;&#39;&gt;</span><span class="si">{</span><span class="n">label_text</span><span class="si">}</span><span class="s2">&lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&#39;result-desc&#39;&gt;</span><span class="si">{</span><span class="n">desc_text</span><span class="si">}</span><span class="s2">&lt;/div&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">                &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                
                <span class="c1"># Tampilkan detail probabilitas jika ada</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;predict_proba&quot;</span><span class="p">):</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">caption</span><span class="p">(</span><span class="s2">&quot;Distribusi Probabilitas Model:&quot;</span><span class="p">)</span>
                    <span class="n">prob_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">probs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">bar_chart</span><span class="p">(</span><span class="n">prob_df</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">text_color</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

            <span class="c1"># Kolom Kanan: Gauge Chart (Spidometer)</span>
            <span class="k">with</span> <span class="n">col_res2</span><span class="p">:</span>
                <span class="n">fig_gauge</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Indicator</span><span class="p">(</span>
                    <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;gauge+number&quot;</span><span class="p">,</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">confidence</span><span class="p">,</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s2">&quot;Tingkat Keyakinan&quot;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#555&#39;</span><span class="p">}},</span>
                    <span class="n">number</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;suffix&#39;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}},</span>
                    <span class="n">gauge</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="s1">&#39;tickwidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;tickcolor&#39;</span><span class="p">:</span> <span class="s2">&quot;#333&quot;</span><span class="p">},</span>
                        <span class="s1">&#39;bar&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">gauge_color</span><span class="p">},</span>
                        <span class="s1">&#39;bgcolor&#39;</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span>
                        <span class="s1">&#39;borderwidth&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                        <span class="s1">&#39;bordercolor&#39;</span><span class="p">:</span> <span class="s2">&quot;#eee&quot;</span><span class="p">,</span>
                        <span class="s1">&#39;steps&#39;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#f9f9f9&#39;</span><span class="p">},</span>
                            <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#f0f0f0&#39;</span><span class="p">}</span>
                        <span class="p">],</span>
                    <span class="p">}</span>
                <span class="p">))</span>
                <span class="n">fig_gauge</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
                <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_gauge</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Link GitHub: <a class="github reference external" href="https://github.com/AqbilBarakaa/psd_deploy_uas">AqbilBarakaa/psd_deploy_uas</a></p>
</section>
<section id="mempersiapkan-lingkungan-aplikasi">
<h3>Mempersiapkan lingkungan aplikasi<a class="headerlink" href="#mempersiapkan-lingkungan-aplikasi" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pip</span> install streamlit pandas numpy joblib plotly scikit-learn
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: streamlit in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (1.46.0)
Requirement already satisfied: pandas in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (2.1.4)
Requirement already satisfied: numpy in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (1.26.4)
Requirement already satisfied: joblib in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (1.3.2)
Requirement already satisfied: plotly in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (6.3.0)
Requirement already satisfied: scikit-learn in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (1.4.2)
Requirement already satisfied: altair&lt;6,&gt;=4.0 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (5.5.0)
Requirement already satisfied: blinker&lt;2,&gt;=1.5.0 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (1.9.0)
Requirement already satisfied: cachetools&lt;7,&gt;=4.0 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (6.1.0)
Requirement already satisfied: click&lt;9,&gt;=7.0 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (8.1.8)
Requirement already satisfied: packaging&lt;26,&gt;=20 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (24.2)
Requirement already satisfied: pillow&lt;12,&gt;=7.1.0 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (11.2.1)
Requirement already satisfied: protobuf&lt;7,&gt;=3.20 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (6.31.1)
Requirement already satisfied: pyarrow&gt;=7.0 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (20.0.0)
Requirement already satisfied: requests&lt;3,&gt;=2.27 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (2.32.3)
Requirement already satisfied: tenacity&lt;10,&gt;=8.1.0 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (9.1.2)
Requirement already satisfied: toml&lt;2,&gt;=0.10.1 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (0.10.2)
Requirement already satisfied: typing-extensions&lt;5,&gt;=4.4.0 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (4.13.2)
Requirement already satisfied: watchdog&lt;7,&gt;=2.1.5 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (6.0.0)
Requirement already satisfied: gitpython!=3.1.19,&lt;4,&gt;=3.0.7 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (3.1.44)
Requirement already satisfied: pydeck&lt;1,&gt;=0.8.0b4 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from streamlit) (0.9.1)
Requirement already satisfied: tornado!=6.5.0,&lt;7,&gt;=6.0.3 in c:\users\acer\appdata\roaming\python\python39\site-packages (from streamlit) (6.4.2)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in c:\users\acer\appdata\roaming\python\python39\site-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from pandas) (2025.2)
Requirement already satisfied: tzdata&gt;=2022.1 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from pandas) (2025.2)
Requirement already satisfied: jinja2 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from altair&lt;6,&gt;=4.0-&gt;streamlit) (3.1.6)
Requirement already satisfied: jsonschema&gt;=3.0 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from altair&lt;6,&gt;=4.0-&gt;streamlit) (4.23.0)
Requirement already satisfied: narwhals&gt;=1.14.2 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from altair&lt;6,&gt;=4.0-&gt;streamlit) (1.44.0)
Requirement already satisfied: colorama in c:\users\acer\appdata\roaming\python\python39\site-packages (from click&lt;9,&gt;=7.0-&gt;streamlit) (0.4.6)
Requirement already satisfied: gitdb&lt;5,&gt;=4.0.1 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from gitpython!=3.1.19,&lt;4,&gt;=3.0.7-&gt;streamlit) (4.0.12)
Requirement already satisfied: smmap&lt;6,&gt;=3.0.1 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from gitdb&lt;5,&gt;=4.0.1-&gt;gitpython!=3.1.19,&lt;4,&gt;=3.0.7-&gt;streamlit) (5.0.2)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from requests&lt;3,&gt;=2.27-&gt;streamlit) (2.0.12)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from requests&lt;3,&gt;=2.27-&gt;streamlit) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from requests&lt;3,&gt;=2.27-&gt;streamlit) (1.26.20)
Requirement already satisfied: certifi&gt;=2017.4.17 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from requests&lt;3,&gt;=2.27-&gt;streamlit) (2025.4.26)
Requirement already satisfied: scipy&gt;=1.6.0 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from scikit-learn) (1.11.4)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from scikit-learn) (3.6.0)
Requirement already satisfied: MarkupSafe&gt;=2.0 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from jinja2-&gt;altair&lt;6,&gt;=4.0-&gt;streamlit) (3.0.2)
Requirement already satisfied: attrs&gt;=22.2.0 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from jsonschema&gt;=3.0-&gt;altair&lt;6,&gt;=4.0-&gt;streamlit) (25.3.0)
Requirement already satisfied: jsonschema-specifications&gt;=2023.03.6 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from jsonschema&gt;=3.0-&gt;altair&lt;6,&gt;=4.0-&gt;streamlit) (2025.4.1)
Requirement already satisfied: referencing&gt;=0.28.4 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from jsonschema&gt;=3.0-&gt;altair&lt;6,&gt;=4.0-&gt;streamlit) (0.36.2)
Requirement already satisfied: rpds-py&gt;=0.7.1 in c:\users\acer\appdata\local\programs\python\python39\lib\site-packages (from jsonschema&gt;=3.0-&gt;altair&lt;6,&gt;=4.0-&gt;streamlit) (0.25.0)
Requirement already satisfied: six&gt;=1.5 in c:\users\acer\appdata\roaming\python\python39\site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas) (1.17.0)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[notice] A new release of pip is available: 25.2 -&gt; 25.3
[notice] To update, run: C:\Users\acer\AppData\Local\Programs\Python\Python39\python.exe -m pip install --upgrade pip
</pre></div>
</div>
</div>
</div>
</section>
<section id="menjalankan-aplikasi">
<h3>Menjalankan Aplikasi<a class="headerlink" href="#menjalankan-aplikasi" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">streamlit</span> <span class="pre">run</span> <span class="pre">app.py</span></code></p>
</section>
<section id="hasil-deploy">
<h3>Hasil Deploy:<a class="headerlink" href="#hasil-deploy" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://psddeployuas.streamlit.app/">https://psddeployuas.streamlit.app/</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="jaraksuara.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Menghitung jarak antara data lama (buka tutup) masing masing 100 data dengan data baru 1 data menggunakan Dynamic Time Warping (DTW)</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#business-understanding">1. BUSINESS UNDERSTANDING</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#latar-belakang-masalah">1.1. Latar Belakang Masalah</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan-proyek">1.2. Tujuan Proyek</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manfaat-bisnis">1.3. Manfaat Bisnis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pertanyaan-analisis">1.4. Pertanyaan Analisis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodologi-crisp-dm">1.5. Metodologi: CRISP-DM</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">2. DATA UNDERSTANDING</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-library-dan-konfigurasi-tampilan">Import library dan konfigurasi tampilan.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-dataset-inspeksi-awal">Load Dataset &amp; Inspeksi Awal</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pengecekan-struktur-distribusi-kelas">Pengecekan Struktur &amp; Distribusi Kelas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#statistik-deskriptif">Statistik Deskriptif</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deteksi-outlier-berbasis-statistik-distance-to-centroid">Deteksi Outlier Berbasis Statistik (Distance to Centroid)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-data">3. PREPROCESSING DATA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eksperimen-seleksi-metode">Eksperimen Seleksi Metode</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eksekusi-final-visualisasi-before-vs-after">Eksekusi Final &amp; Visualisasi (Before vs After)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grafik-pipeline-tracking">Grafik Pipeline Tracking</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#komparasi-detail-per-kelas-sebelum-vs-sesudah">Komparasi Detail Per Kelas (Sebelum vs Sesudah)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling">4. MODELING</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling-data">Scaling Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#training-benchmarking-loop">Training &amp; Benchmarking Loop</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Training &amp; Benchmarking Loop</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confusion-matrix">Confusion Matrix</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluasi">5. EVALUASI</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-feature-importance">Analisis Feature Importance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-feature-importance">Visualisasi Feature Importance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kurva-roc-auc-seluruh-model">Kurva ROC-AUC Seluruh Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kurva-roc-auc-model-terbaik">Kurva ROC-AUC Model Terbaik</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#penyimpanan-model">PENYIMPANAN MODEL</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulasi-prediksi">Simulasi Prediksi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deployment">6. Deployment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-dan-simpan-model-pada-folder-deploy">Load dan simpan model pada folder deploy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#membuat-file-app-py-dengan-code">Membuat file <code class="docutils literal notranslate"><span class="pre">app.py</span></code> dengan code:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mempersiapkan-lingkungan-aplikasi">Mempersiapkan lingkungan aplikasi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menjalankan-aplikasi">Menjalankan Aplikasi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hasil-deploy">Hasil Deploy:</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aqbil Baraka
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>